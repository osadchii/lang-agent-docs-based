# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------
# Friendly name used in OpenAPI + logs
PROJECT_NAME=Lang Agent Backend
# Runtime environment: local | test | staging | production
APP_ENV=local
# Enable FastAPI debug docs + verbose errors
DEBUG=true
# Prefix for all API v1 routes
API_V1_PREFIX=/api
# Global log level: DEBUG | INFO | WARNING | ERROR
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Security / Auth
# -----------------------------------------------------------------------------
# JWT signing secret (generate: openssl rand -hex 32)
SECRET_KEY=change-me
# Algorithm used to sign JWTs
JWT_ALGORITHM=HS256
# TTL for access tokens (minutes)
ACCESS_TOKEN_EXPIRE_MINUTES=30

# -----------------------------------------------------------------------------
# Data stores
# -----------------------------------------------------------------------------
# SQLAlchemy async URL (local default shown)
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/lang_agent
# Redis connection string
REDIS_URL=redis://localhost:6379/0

# -----------------------------------------------------------------------------
# External providers
# -----------------------------------------------------------------------------
# Telegram bot token from BotFather
TELEGRAM_BOT_TOKEN=123456:ABCDEF-placeholder
# OpenAI key for the default LLM provider
OPENAI_API_KEY=sk-your-openai-key
# Optional: Anthropic key if/when Claude is enabled
ANTHROPIC_API_KEY=
# Default LLM configuration
LLM_MODEL=gpt-4.1-mini
LLM_TEMPERATURE=0.7
# OpenAI moderation model for content safety
OPENAI_MODERATION_MODEL=omni-moderation-latest
# Telegram voice â†’ Whisper configuration
VOICE_TRANSCRIPTION_MODEL=whisper-1
VOICE_TRANSCRIPTION_TIMEOUT=60
# Telegram limits voice duration to 2 minutes; keep margin below
VOICE_MAX_DURATION_SECONDS=120
# Default Telegram OGG ~1 MB/min, keep buffer for safety
VOICE_MAX_FILE_SIZE_BYTES=3000000
# Vision OCR configuration
OCR_VISION_MODEL=gpt-4o-mini
OCR_VISION_TIMEOUT=60
OCR_MAX_IMAGES=3
# 10 MiB per image max
OCR_MAX_IMAGE_BYTES=10485760
OCR_MAX_IMAGE_DIMENSION=2048
OCR_MAX_OUTPUT_TOKENS=900

# -----------------------------------------------------------------------------
# HTTP surface
# -----------------------------------------------------------------------------
# Production Mini App origin (https://mini.example.com)
PRODUCTION_APP_ORIGIN=https://mini.lang-agent.app
# Public backend domain (used by nginx-proxy/Let's Encrypt)
BACKEND_DOMAIN=backend.domain
# Public frontend domain (used by nginx-proxy/Let's Encrypt)
FRONTEND_DOMAIN=app.domain
# Local frontend whitelist (comma or JSON list, only http://localhost:PORT; used when APP_ENV=local/test)
BACKEND_CORS_ORIGINS=http://localhost:4173
# Max allowed request body size in bytes (default 32 MiB)
MAX_REQUEST_BYTES=33554432
# Rate limiting (per docs/backend-api.md)
RATE_LIMIT_IP_PER_MINUTE=100
RATE_LIMIT_USER_PER_HOUR=1000
RATE_LIMIT_FREE_LLM_PER_DAY=50
RATE_LIMIT_PREMIUM_LLM_PER_DAY=500
RATE_LIMIT_FREE_EXERCISES_PER_DAY=10
# 0 disables the premium exercise limit (unlimited)
RATE_LIMIT_PREMIUM_EXERCISES_PER_DAY=0
RATE_LIMIT_WORKER_ENABLED=false
RATE_LIMIT_RESET_HOUR_UTC=0
RATE_LIMIT_RESET_MINUTE_UTC=5

# -----------------------------------------------------------------------------
# Notifications
# -----------------------------------------------------------------------------
NOTIFICATION_WORKER_ENABLED=false
NOTIFICATION_WORKER_INTERVAL_SECONDS=1800
STREAK_REMINDER_WINDOW_START=17
STREAK_REMINDER_WINDOW_END=19
STREAK_REMINDER_RETENTION_DAYS=7

# -----------------------------------------------------------------------------
# Payments (optional, for subscriptions)
# -----------------------------------------------------------------------------
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PRICE_ID_BASIC=
STRIPE_PRICE_ID_PREMIUM=

# -----------------------------------------------------------------------------
# Docker / deployment helpers
# -----------------------------------------------------------------------------
# Override DB creds for docker-compose.yml
POSTGRES_DB=lang_agent
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
# Backend container reference
BACKEND_IMAGE=ghcr.io/osadchii/lang-agent-docs-based/backend
BACKEND_IMAGE_TAG=latest
# Frontend container reference
FRONTEND_IMAGE=ghcr.io/osadchii/lang-agent-docs-based/frontend
FRONTEND_IMAGE_TAG=latest

# -----------------------------------------------------------------------------
# Observability stack
# -----------------------------------------------------------------------------
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change-me
GRAFANA_DOMAIN=monitor.example.com
TRAEFIK_ACME_EMAIL=ops@example.com

# -----------------------------------------------------------------------------
# Backups
# -----------------------------------------------------------------------------
BACKUP_DIR=/var/backups/postgres
BACKUP_PREFIX=lang-agent
BACKUP_RETENTION_DAILY_DAYS=30
BACKUP_RETENTION_WEEKLY_DAYS=90
BACKUP_RETENTION_MONTHLY_DAYS=365
BACKUP_WEEKLY_DAY=7
BACKUP_MONTHLY_DAY=01
BACKUP_ENABLE_RCLONE=false
BACKUP_REMOTE=
BACKUP_REMOTE_PATH=
