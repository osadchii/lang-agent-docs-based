# –ù–∞–≤–∏–≥–∞—Ü–∏—è Frontend

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

### Bottom Navigation (–æ—Å–Ω–æ–≤–Ω–∞—è)

**–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ (–∫—Ä–æ–º–µ —Ä–µ–∂–∏–º–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏)**

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- Height: 80px + safe area
- Background: `#1A1D35` —Å blur —ç—Ñ—Ñ–µ–∫—Ç–æ–º
- Border Top: 1px solid `rgba(255, 107, 53, 0.1)`
- Fixed position
- Z-index: 1000

**4 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∞:**

1. **Home (–ì–ª–∞–≤–Ω–∞—è)** - `/`
   - Icon: house
   - –î–∞—à–±–æ—Ä–¥ —Å quick actions
   - –ê–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
   - –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ —Å–µ–≥–æ–¥–Ω—è
   - –°—Ç—Ä–∏–∫

2. **Practice (–ü—Ä–∞–∫—Ç–∏–∫–∞)** - `/practice`
   - Icon: cards/dumbbell
   - Tabs: –ö–∞—Ä—Ç–æ—á–∫–∏ | –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
   - –†–µ–∂–∏–º—ã –∏–∑—É—á–µ–Ω–∏—è (–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–µ, –±–µ–∑ bottom nav)

3. **Groups (–ì—Ä—É–ø–ø—ã)** - `/groups`
   - Icon: users/people
   - Badge —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - Tabs: –ú–æ–∏ –≥—Ä—É–ø–ø—ã | –£—á–∞—Å—Ç–Ω–∏–∫

4. **Profile (–ü—Ä–æ—Ñ–∏–ª—å)** - `/profile`
   - Icon: user/person
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ü–æ–¥–ø–∏—Å–∫–∞
   - –Ø–∑—ã–∫–æ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏

**–°–æ—Å—Ç–æ—è–Ω–∏—è:**
- Active tab: –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –∏–∫–æ–Ω–∫–∞ + –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç
- Inactive: —Å–µ—Ä–∞—è –∏–∫–æ–Ω–∫–∞ (#6B6E82) + —Å–µ—Ä—ã–π —Ç–µ–∫—Å—Ç
- Tap animation: scale 1.1

**–°–∫—Ä—ã—Ç–∏–µ Bottom Navigation:**
- –†–µ–∂–∏–º –∏–∑—É—á–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ (–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π)
- –†–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π (–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π)
- –û–Ω–±–æ—Ä–¥–∏–Ω–≥ (5 —ç–∫—Ä–∞–Ω–æ–≤)
- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (overlay –ø–æ–≤–µ—Ä—Ö)

---

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è

#### Header Navigation

**Top bar —ç–ª–µ–º–µ–Ω—Ç—ã:**
- Back button (–Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö)
- Page title
- Action buttons (—Å–ø—Ä–∞–≤–∞): settings, add, menu dots
- Notifications bell (–≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω)

#### Modal Navigation

**Bottom Sheets:**
- –í—ã–±–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è
- –í—ã–±–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–π –∫–æ–ª–æ–¥—ã
- –í—ã–±–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–π —Ç–µ–º—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ –≥—Ä—É–ø–ø—É
- –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ–º—ã
- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–∏
- –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**Characteristics:**
- Drag handle –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
- Backdrop: rgba(0,0,0,0.6)
- Swipe down to dismiss
- Heights: 30%, 50%, 70%, auto

#### Full Screen Modals

**–≠–∫—Ä–∞–Ω—ã —Å –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º:**
- –û–Ω–±–æ—Ä–¥–∏–Ω–≥ (5 —à–∞–≥–æ–≤)
- –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
- –î–µ—Ç–∞–ª–∏ –∫–æ–ª–æ–¥—ã/—Ç–µ–º—ã
- –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ Premium
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π

**Navigation:**
- Back button –∏–ª–∏ Close (X)
- –ù–µ—Ç bottom navigation
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è parent screen

#### Tabs Navigation

**Segmented Controls –≤–Ω—É—Ç—Ä–∏ —ç–∫—Ä–∞–Ω–æ–≤:**

1. **Practice ‚Üí –ö–∞—Ä—Ç–æ—á–∫–∏:**
   - –£—á–∏—Ç—å | –ö–æ–ª–æ–¥—ã

2. **Practice ‚Üí –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:**
   - –ü—Ä–∞–∫—Ç–∏–∫–∞ | –¢–µ–º—ã

3. **Groups:**
   - –ú–æ–∏ –≥—Ä—É–ø–ø—ã | –£—á–∞—Å—Ç–Ω–∏–∫

4. **–î–µ—Ç–∞–ª–∏ –≥—Ä—É–ø–ø—ã:**
   - –£—á–∞—Å—Ç–Ω–∏–∫–∏ | –ú–∞—Ç–µ—Ä–∏–∞–ª—ã

5. **–î–µ—Ç–∞–ª–∏ –∫–æ–ª–æ–¥—ã/—Ç–µ–º—ã:**
   - –û—Å–Ω–æ–≤–Ω–æ–µ | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ | –ò—Å—Ç–æ—Ä–∏—è

6. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - –í—Å–µ | –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ

7. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏:**
   - –û–¥–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞ | –°–ø–∏—Å–æ–∫

8. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤:**
   - –ú–æ–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π

**Styling:**
- Full width
- Active: –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
- Inactive: –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω
- Smooth transition: 250ms

---

## Routing –∏ –º–∞—Ä—à—Ä—É—Ç—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

```
/                          ‚Üí Home (–≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω)
/onboarding               ‚Üí –û–Ω–±–æ—Ä–¥–∏–Ω–≥ (5 —à–∞–≥–æ–≤)
  /onboarding/language    ‚Üí –®–∞–≥ 1: –≤—ã–±–æ—Ä —è–∑—ã–∫–∞
  /onboarding/current     ‚Üí –®–∞–≥ 2: —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å
  /onboarding/target      ‚Üí –®–∞–≥ 3: —Ü–µ–ª–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å
  /onboarding/goal        ‚Üí –®–∞–≥ 4: —Ü–µ–ª—å –∏–∑—É—á–µ–Ω–∏—è
  /onboarding/interface   ‚Üí –®–∞–≥ 5: —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

/practice                 ‚Üí –ü—Ä–∞–∫—Ç–∏–∫–∞ (redirect to /practice/cards)
  /practice/cards         ‚Üí –ö–∞—Ä—Ç–æ—á–∫–∏ (tab: –£—á–∏—Ç—å | –ö–æ–ª–æ–¥—ã)
    /practice/cards/study ‚Üí –†–µ–∂–∏–º –∏–∑—É—á–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ (–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π)
    /practice/cards/session-complete ‚Üí –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
    /practice/cards/deck/:deckId ‚Üí –î–µ—Ç–∞–ª–∏ –∫–æ–ª–æ–¥—ã
    /practice/cards/card/:cardId ‚Üí –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ (–±—Ä–∞—É–∑–µ—Ä)
  /practice/exercises     ‚Üí –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (tab: –ü—Ä–∞–∫—Ç–∏–∫–∞ | –¢–µ–º—ã)
    /practice/exercises/session ‚Üí –†–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π)
    /practice/exercises/session-complete ‚Üí –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
    /practice/exercises/topic/:topicId ‚Üí –î–µ—Ç–∞–ª–∏ —Ç–µ–º—ã

/groups                   ‚Üí –ì—Ä—É–ø–ø—ã (tab: –ú–æ–∏ –≥—Ä—É–ø–ø—ã | –£—á–∞—Å—Ç–Ω–∏–∫)
  /groups/create          ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
  /groups/:groupId        ‚Üí –î–µ—Ç–∞–ª–∏ –≥—Ä—É–ø–ø—ã (tab: –£—á–∞—Å—Ç–Ω–∏–∫–∏ | –ú–∞—Ç–µ—Ä–∏–∞–ª—ã)
  /groups/:groupId/edit   ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
  /groups/:groupId/participant/:userId ‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å —É—á–∞—Å—Ç–Ω–∏–∫–∞

/profile                  ‚Üí –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  /profile/edit           ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
  /profile/profiles       ‚Üí –°–ø–∏—Å–æ–∫ —è–∑—ã–∫–æ–≤—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π
  /profile/profiles/create ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
  /profile/profiles/:profileId/edit ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —è–∑—ã–∫–∞
  /profile/stats          ‚Üí –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è)
  /profile/settings       ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏
  /profile/subscription   ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π
  /profile/premium        ‚Üí –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ Premium

/notifications            ‚Üí –°–ø–∏—Å–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (modal)
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤

**Path parameters:**
- `:deckId` - UUID –∫–æ–ª–æ–¥—ã
- `:cardId` - UUID –∫–∞—Ä—Ç–æ—á–∫–∏
- `:topicId` - UUID —Ç–µ–º—ã
- `:groupId` - UUID –≥—Ä—É–ø–ø—ã
- `:userId` - UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `:profileId` - UUID —è–∑—ã–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

**Query parameters:**
```
?tab=                    ‚Üí –ê–∫—Ç–∏–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ (mine|groups|all)
?filter=                 ‚Üí –§–∏–ª—å—Ç—Ä —Å–ø–∏—Å–∫–∞ (grammar|vocabulary|new)
?period=                 ‚Üí –ü–µ—Ä–∏–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (week|month|3months|year|all)
?from=                   ‚Üí –ò—Å—Ç–æ—á–Ω–∏–∫ –ø–µ—Ä–µ—Ö–æ–¥–∞ (bot|notification|share)
?action=                 ‚Üí –î–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ (invite|add-material)
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```
/practice/cards?tab=decks
/groups?tab=participant
/profile/stats?period=month
/groups/123?from=notification&action=invite
```

### Navigation Guards

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º:**

1. **Onboarding Guard:**
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–æ–≤—ã–π (–Ω–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è) ‚Üí redirect to `/onboarding`
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–∞—Ö –∫—Ä–æ–º–µ `/onboarding`

2. **Auth Guard:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram WebApp initData
   - –ï—Å–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–∞ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É "–û—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram"

3. **Premium Guard:**
   - –î–ª—è –¥–µ–π—Å—Ç–≤–∏–π —Ç—Ä–µ–±—É—é—â–∏—Ö Premium
   - –ï—Å–ª–∏ –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ ‚Üí modal —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –æ—Ñ–æ—Ä–º–∏—Ç—å

4. **Profile Guard:**
   - –ï—Å–ª–∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è ‚Üí redirect to `/profile/profiles`

5. **Active Material Guard:**
   - –î–ª—è `/practice/cards/study`: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–æ–ª–æ–¥—ã
   - –î–ª—è `/practice/exercises/session`: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π —Ç–µ–º—ã
   - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å modal –≤—ã–±–æ—Ä–∞ –∏–ª–∏ empty state

---

## Deep Links

### –ü–µ—Ä–µ—Ö–æ–¥—ã –∏–∑ –±–æ—Ç–∞ –≤ Mini App

**–§–æ—Ä–º–∞—Ç:**
```
https://t.me/YourBot/app?startapp=<command>
```

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

#### 1. –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞

```
startapp=home                  ‚Üí –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
startapp=practice_cards        ‚Üí –ö–∞—Ä—Ç–æ—á–∫–∏
startapp=practice_exercises    ‚Üí –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
startapp=groups                ‚Üí –ì—Ä—É–ø–ø—ã
startapp=profile               ‚Üí –ü—Ä–æ—Ñ–∏–ª—å
startapp=stats                 ‚Üí –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```

#### 2. –î–µ–π—Å—Ç–≤–∏—è —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏

```
startapp=card_{cardId}         ‚Üí –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ä—Ç–æ—á–∫–∏
startapp=deck_{deckId}         ‚Üí –û—Ç–∫—Ä—ã—Ç—å –∫–æ–ª–æ–¥—É
startapp=study                 ‚Üí –ù–∞—á–∞—Ç—å –∏–∑—É—á–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
startapp=add_card              ‚Üí –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
```

**–ü—Ä–∏–º–µ—Ä –∏–∑ –±–æ—Ç–∞:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–∏–ª –∫–∞—Ä—Ç–æ—á–∫—É –≤ –±–æ—Ç–µ ‚Üí –∫–Ω–æ–ø–∫–∞ "–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"
```
https://t.me/YourBot/app?startapp=card_abc123
```

#### 3. –î–µ–π—Å—Ç–≤–∏—è —Å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏

```
startapp=exercise              ‚Üí –ù–∞—á–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
startapp=topic_{topicId}       ‚Üí –û—Ç–∫—Ä—ã—Ç—å —Ç–µ–º—É
startapp=add_topic             ‚Üí –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–º—É
```

#### 4. –ì—Ä—É–ø–ø—ã

```
startapp=group_{groupId}               ‚Üí –û—Ç–∫—Ä—ã—Ç—å –≥—Ä—É–ø–ø—É
startapp=invite_{groupId}_{token}      ‚Üí –ü—Ä–∏–Ω—è—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
startapp=group_materials_{groupId}     ‚Üí –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≥—Ä—É–ø–ø—ã
```

**–ü—Ä–∏–º–µ—Ä –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:**
–°–æ–∑–¥–∞—Ç–µ–ª—å –≥—Ä—É–ø–ø—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É —É—á–∞—Å—Ç–Ω–∏–∫—É —á–µ—Ä–µ–∑ –±–æ—Ç–∞
```
https://t.me/YourBot/app?startapp=invite_group123_token456
```

–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ ‚Üí modal —Å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ–º

#### 5. –ü–æ–¥–ø–∏—Å–∫–∞

```
startapp=premium               ‚Üí –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ Premium
startapp=subscription          ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π
```

#### 6. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```
startapp=notification_{notificationId}  ‚Üí –û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
startapp=streak_reminder                ‚Üí –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Å—Ç—Ä–∏–∫–µ ‚Üí –≥–ª–∞–≤–Ω–∞—è
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ Deep Links

**–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ Mini App:**

```typescript
// Pseudo-code
const startParam = Telegram.WebApp.initDataUnsafe.start_param;

if (startParam) {
  const [action, ...params] = startParam.split('_');

  switch (action) {
    case 'card':
      navigate(`/practice/cards/card/${params[0]}`);
      break;
    case 'invite':
      const [groupId, token] = params;
      openInviteModal(groupId, token);
      break;
    case 'study':
      navigate('/practice/cards/study');
      break;
    // ... –¥—Ä—É–≥–∏–µ actions
  }
}
```

**Fallback:**
–ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∏–ª–∏ —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí navigate to home + toast —Å –æ—à–∏–±–∫–æ–π

---

## Back Navigation

### –û–±—Ä–∞–±–æ—Ç–∫–∞ Back Button

**Telegram WebApp Back Button:**

```typescript
// –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å/—Å–∫—Ä—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —ç–∫—Ä–∞–Ω–∞
Telegram.WebApp.BackButton.show();
Telegram.WebApp.BackButton.hide();

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞
Telegram.WebApp.BackButton.onClick(() => {
  // Custom back logic
});
```

**–ü—Ä–∞–≤–∏–ª–∞ –ø–æ–∫–∞–∑–∞:**

**–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å Back Button:**
- –í—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —ç–∫—Ä–∞–Ω—ã (–Ω–µ root routes)
- Modal screens
- –î–µ—Ç–∞–ª–∏ (–∫–æ–ª–æ–¥–∞, —Ç–µ–º–∞, –≥—Ä—É–ø–ø–∞, —É—á–∞—Å—Ç–Ω–∏–∫)
- –†–µ–∂–∏–º—ã –ø—Ä–∞–∫—Ç–∏–∫–∏ (–∫–∞—Ä—Ç–æ—á–∫–∏, —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è)

**–°–∫—Ä—ã–≤–∞—Ç—å Back Button:**
- Root routes: `/`, `/practice`, `/groups`, `/profile`
- –û–Ω–±–æ—Ä–¥–∏–Ω–≥ (–≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "–ù–∞–∑–∞–¥" –≤ UI)
- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (–≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ drag handle –∏ backdrop dismiss)

### Back Navigation Logic

**–°—Ç–µ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:**

```
Home ‚Üí Practice/Cards ‚Üí Deck Details ‚Üí Card View
                                        ‚Üì [Back]
                                      Deck Details
                                        ‚Üì [Back]
                                      Practice/Cards
                                        ‚Üì [Back]
                                      Home
```

**Special cases:**

1. **–†–µ–∂–∏–º –∏–∑—É—á–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫:**
   - Back button ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å confirm dialog
   - "–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ—Å—Å–∏—é?" ‚Üí "–û—Ç–º–µ–Ω–∞" | "–ó–∞–≤–µ—Ä—à–∏—Ç—å"
   - –ï—Å–ª–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å ‚Üí session-complete screen

2. **–†–µ–∂–∏–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π:**
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∫–∞—Ä—Ç–æ—á–∫–∞–º
   - –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

3. **–û–Ω–±–æ—Ä–¥–∏–Ω–≥:**
   - –ü–µ—Ä–≤—ã–π —ç–∫—Ä–∞–Ω: –∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" —Å–∫—Ä—ã—Ç–∞
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã: –≤–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —à–∞–≥—É
   - –ù–µ–ª—å–∑—è –≤—ã–π—Ç–∏ –±–µ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

4. **–ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞:**
   - Back button —Å–∫—Ä—ã—Ç
   - –ó–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ swipe down –∏–ª–∏ backdrop tap

### Browser Back Button

**–î–ª—è –≤–µ–±-–≤–µ—Ä—Å–∏–∏ Mini App:**

```typescript
window.addEventListener('popstate', (event) => {
  // Handle browser back
  // Sync with Telegram.WebApp.BackButton
});
```

**Prevent default back:**
–í —Ä–µ–∂–∏–º–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å confirm dialog –≤–º–µ—Å—Ç–æ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞

---

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–æ—Ç–æ–º

### –û—Ç–∫—Ä—ã—Ç–∏–µ Mini App –∏–∑ –±–æ—Ç–∞

#### –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞

**1. –ö–æ–º–∞–Ω–¥–∞ `/app` –≤ –±–æ—Ç–µ:**
```
/app ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ
```

**2. Inline –∫–Ω–æ–ø–∫–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –±–æ—Ç–∞:**

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏:
```
[–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É] ‚Üí /practice/cards/card/{cardId}
```

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:
```
[–ü–æ–ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏] ‚Üí /practice/exercises/session
```

–í —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ —Å—Ç—Ä–∏–∫–µ:
```
[–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å] ‚Üí /profile/stats
```

–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É:
```
[–ü—Ä–∏–Ω—è—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ] ‚Üí /groups?from=bot&action=invite_{groupId}
```

**3. Menu button:**
–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –≤ –º–µ–Ω—é Telegram —á–∞—Ç–∞:
```
Mini App ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –∏–ª–∏ –≥–ª–∞–≤–Ω—É—é
```

**4. Attachment menu:**
–î–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞ –≤ attachment menu ‚Üí –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ Mini App –∏–∑ –ª—é–±–æ–≥–æ —á–∞—Ç–∞

#### Auto-open scenarios

**–ö–æ–≥–¥–∞ Mini App –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**

1. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç /start
   - –ë–æ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App —Å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–æ–º

2. **–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã Premium:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≤–µ—Ä—à–∏–ª –æ–ø–ª–∞—Ç—É –≤ Stripe
   - Webhook ‚Üí –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
   - –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" ‚Üí /profile/subscription

### –í–æ–∑–≤—Ä–∞—Ç –≤ –±–æ—Ç

#### –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç —Å –±–æ—Ç–æ–º"

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- –í –º–µ–Ω—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (settings, hamburger menu)
- –ù–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–º–æ—â–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–∞–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
Telegram.WebApp.openTelegramLink('https://t.me/YourBot');
```

–∏–ª–∏

```typescript
Telegram.WebApp.close(); // –ó–∞–∫—Ä—ã–≤–∞–µ—Ç Mini App, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤ —á–∞—Ç
```

#### –°—Ü–µ–Ω–∞—Ä–∏–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞

**1. –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å –±–æ—Ç–∞:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å ‚Üí –∫–Ω–æ–ø–∫–∞ "–°–ø—Ä–æ—Å–∏—Ç—å –±–æ—Ç–∞"
```typescript
Telegram.WebApp.close();
// –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ —á–∞—Ç
Telegram.WebApp.sendData(JSON.stringify({ action: 'ask_question' }));
```

**2. –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É —á–µ—Ä–µ–∑ –±–æ—Ç–∞:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥ –≤ –±–æ—Ç–µ
```typescript
Telegram.WebApp.openTelegramLink('https://t.me/YourBot?text=–î–æ–±–∞–≤—å –≤ –∫–∞—Ä—Ç–æ—á–∫–∏');
```

**3. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≤–µ—Ä—à–∏–ª —Å–µ—Å—Å–∏—é –∫–∞—Ä—Ç–æ—á–µ–∫ ‚Üí –∫–Ω–æ–ø–∫–∞ "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —á–∞—Ç"

### Sharing –∫–æ–Ω—Ç–µ–Ω—Ç–∞

#### –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∏–∑ Mini App –≤ —á–∞—Ç

**1. –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É:**
```typescript
const inviteLink = `https://t.me/YourBot/app?startapp=invite_${groupId}_${token}`;
const text = `–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –º–æ–µ–π –≥—Ä—É–ø–ø–µ "${groupName}" –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è ${language}!`;

Telegram.WebApp.openTelegramLink(
  `https://t.me/share/url?url=${encodeURIComponent(inviteLink)}&text=${encodeURIComponent(text)}`
);
```

**2. –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ–º:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ—Å—Ç–∏–≥ —Å—Ç—Ä–∏–∫–∞ 30 –¥–Ω–µ–π ‚Üí –∫–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
```typescript
const text = 'üî• –Ø –∏–∑—É—á–∞—é –∏—Å–ø–∞–Ω—Å–∫–∏–π —É–∂–µ 30 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥! –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å!';
const url = 'https://t.me/YourBot/app';

Telegram.WebApp.shareToStory(mediaUrl, {
  text: text,
  widget_link: {
    url: url,
    name: '–ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ'
  }
});
```

**3. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–æ–¥—É:**
```typescript
const deckData = JSON.stringify({
  name: deckName,
  cards: cardsData
});

// –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
Telegram.WebApp.sendData(deckData);
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–æ—Ç–∞

**–ö–æ–≥–¥–∞ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ Mini App:**

1. **–°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª —Ç–µ–∫—Å—Ç ‚Üí –±–æ—Ç –Ω–∞—à–µ–ª —Å–ª–æ–≤–∞ ‚Üí –∫–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"
```typescript
// Data from bot
{
  action: 'add_cards',
  words: ['palabra1', 'palabra2', ...]
}

// Handler in Mini App
if (data.action === 'add_cards') {
  navigate('/practice/cards/add', { state: { words: data.words } });
}
```

2. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã OCR:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Ñ–æ—Ç–æ ‚Üí –±–æ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–ª —Ç–µ–∫—Å—Ç ‚Üí "–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–∞"
```typescript
{
  action: 'add_from_ocr',
  text: 'recognized text',
  words: ['word1', 'word2', ...]
}
```

---

## State Management –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### Session Storage (–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ)

**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ sessionStorage:**
```typescript
{
  // –ê–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
  'cards_filter': { tab: 'mine', search: 'casa' },
  'groups_filter': { tab: 'participant' },

  // –°–∫—Ä–æ–ª–ª –ø–æ–∑–∏—Ü–∏–∏
  'scroll_position_/practice/cards': 1240,

  // –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º
  'card_draft': { word: 'example', deck_id: '123' },

  // –ü–æ—Å–ª–µ–¥–Ω–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
  'last_route': '/practice/cards'
}
```

**Use cases:**
- –í–æ–∑–≤—Ä–∞—Ç –∫ —Ç–æ–π –∂–µ –ø–æ–∑–∏—Ü–∏–∏ —Å–∫—Ä–æ–ª–ª–∞ –ø–æ—Å–ª–µ back navigation
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –¥—Ä—É–≥–æ–π —ç–∫—Ä–∞–Ω
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ progress bar –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

**–û—á–∏—Å—Ç–∫–∞:**
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ Mini App (session ends)
- –ü—Ä–∏ logout
- –ü—Ä–∏ —Å–º–µ–Ω–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

#### Local Storage (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ)

**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ localStorage:**
```typescript
{
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  'user_settings': {
    card_side: 'random',
    notifications_enabled: true,
    timezone: 'Europe/Moscow'
  },

  // –ö—ç—à –¥–∞–Ω–Ω—ã—Ö
  'active_profile': { id: '123', language: 'es', level: 'A2' },
  'active_deck': { id: '456', name: '–ú–æ–∏ —Å–ª–æ–≤–∞' },
  'active_topic': { id: '789', name: 'Past Simple' },

  // UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  'onboarding_completed': true,
  'premium_modal_shown': 2, // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫–∞–∑–æ–≤

  // Offline support (future)
  'cached_cards': [...],
  'pending_sync': [...]
}
```

**Use cases:**
- –ó–∞–ø–æ–º–Ω–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –∫–æ–ª–æ–¥—É/—Ç–µ–º—É –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
- –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å onboarding –ø–æ–≤—Ç–æ—Ä–Ω–æ
- Offline mode: –∫—ç—à –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

**–û—á–∏—Å—Ç–∫–∞:**
- –ü—Ä–∏ logout
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è (–µ—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–π)
- –ü–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí "–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à")

### Navigation State

**React Router State:**
```typescript
// –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å state
navigate('/practice/cards/deck/123', {
  state: {
    fromSearch: true,
    highlightCard: 'card_456'
  }
});

// –ù–∞ —Ü–µ–ª–µ–≤–æ–º —ç–∫—Ä–∞–Ω–µ
const location = useLocation();
const { fromSearch, highlightCard } = location.state || {};
```

**Use cases:**
- –ü–µ—Ä–µ–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞ (–æ—Ç–∫—É–¥–∞ –ø—Ä–∏—à–ª–∏)
- –í—ã–¥–µ–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞
- –ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞

### Persist on Reload

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ reload:**

```typescript
// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
function initApp() {
  const lastRoute = sessionStorage.getItem('last_route');
  const scrollPosition = sessionStorage.getItem(`scroll_position_${lastRoute}`);

  if (lastRoute && lastRoute !== '/onboarding') {
    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç
    navigate(lastRoute, { replace: true });

    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∫—Ä–æ–ª–ª
    setTimeout(() => {
      window.scrollTo(0, scrollPosition || 0);
    }, 100);
  }
}
```

**Exceptions:**
- –†–µ–∂–∏–º—ã –ø—Ä–∞–∫—Ç–∏–∫–∏: –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º (–Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–Ω–æ–≤–æ)
- Onboarding: –≤—Å–µ–≥–¥–∞ —Å –Ω–∞—á–∞–ª–∞
- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞: –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º

---

## –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

#### 1. React Query (–¥–ª—è API –¥–∞–Ω–Ω—ã—Ö)

**Cache –≤—Ä–µ–º–µ–Ω–∞:**
```typescript
{
  // –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è - –¥–æ–ª–≥–æ
  'user_profile': { staleTime: 5 * 60 * 1000, cacheTime: 30 * 60 * 1000 },

  // –°–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç–æ—á–µ–∫ - —Å—Ä–µ–¥–Ω–µ
  'cards_list': { staleTime: 2 * 60 * 1000, cacheTime: 10 * 60 * 1000 },

  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - –∫–æ—Ä–æ—Ç–∫–æ
  'stats': { staleTime: 30 * 1000, cacheTime: 5 * 60 * 1000 },

  // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–æ
  'notifications': { staleTime: 10 * 1000, cacheTime: 1 * 60 * 1000 }
}
```

**–°—Ç—Ä–∞—Ç–µ–≥–∏–∏:**

1. **Stale-While-Revalidate (SWR):**
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
   - –í —Ñ–æ–Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ–º —Å–≤–µ–∂–∏–µ
   - –û–±–Ω–æ–≤–ª—è–µ–º UI –∫–æ–≥–¥–∞ –ø–æ–ª—É—á–∏–º –æ—Ç–≤–µ—Ç

2. **Cache-First:**
   - –î–ª—è —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—â–∏—Ö—Å—è –¥–∞–Ω–Ω—ã—Ö (—è–∑—ã–∫–æ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏)
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–≤–µ–∂–µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —è–≤–Ω–æ–º refresh

3. **Network-First:**
   - –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–æ–≥—Ä–µ—Å—Å –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–∞–∫—Ç–∏–∫–∏)
   - –í—Å–µ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º —Å —Å–µ—Ä–≤–µ—Ä–∞, fallback –Ω–∞ –∫—ç—à –ø—Ä–∏ –æ—à–∏–±–∫–µ

#### 2. Prefetching

**–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**

```typescript
// –ù–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ prefetch –¥–∞–Ω–Ω—ã—Ö –¥–ª—è practice
useEffect(() => {
  queryClient.prefetchQuery(['active_deck']);
  queryClient.prefetchQuery(['cards_today']);
  queryClient.prefetchQuery(['active_topic']);
}, []);

// –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ù–∞—á–∞—Ç—å –∏–∑—É—á–µ–Ω–∏–µ"
<Button
  onMouseEnter={() => {
    queryClient.prefetchQuery(['next_card']);
  }}
>
  –ù–∞—á–∞—Ç—å –∏–∑—É—á–µ–Ω–∏–µ
</Button>
```

**Use cases:**
- Prefetch —Å–ª–µ–¥—É—é—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –≤–æ –≤—Ä–µ–º—è –ø–æ–∫–∞–∑–∞ —Ç–µ–∫—É—â–µ–π
- Prefetch –¥–µ—Ç–∞–ª–µ–π –∫–æ–ª–æ–¥—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –≤ —Å–ø–∏—Å–∫–µ
- Prefetch –≥—Ä—É–ø–ø—ã –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–∏

#### 3. Optimistic Updates

**–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI:**

```typescript
// –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
const addCardMutation = useMutation(addCard, {
  onMutate: async (newCard) => {
    // Cancel outgoing queries
    await queryClient.cancelQueries(['cards', deckId]);

    // Snapshot previous value
    const previousCards = queryClient.getQueryData(['cards', deckId]);

    // Optimistically update
    queryClient.setQueryData(['cards', deckId], old => [...old, newCard]);

    return { previousCards };
  },
  onError: (err, newCard, context) => {
    // Rollback on error
    queryClient.setQueryData(['cards', deckId], context.previousCards);
  },
  onSettled: () => {
    // Refetch to sync
    queryClient.invalidateQueries(['cards', deckId]);
  }
});
```

**Use cases:**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–æ–ª–æ–¥—ã
- –û—Ü–µ–Ω–∫–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ (–ó–Ω–∞—é/–ù–µ –∑–Ω–∞—é)
- –ü—Ä–∏–Ω—è—Ç–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É

#### 4. Cache Invalidation

**–ö–æ–≥–¥–∞ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à:**

```typescript
// –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è ‚Üí –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å—ë —Å–≤—è–∑–∞–Ω–Ω–æ–µ
await updateProfile();
queryClient.invalidateQueries(['profile']);
queryClient.invalidateQueries(['cards']); // –ú–æ–≥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —É—Ä–æ–≤–Ω—è
queryClient.invalidateQueries(['topics']);

// –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏ ‚Üí –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
await completeSession();
queryClient.invalidateQueries(['stats']);
queryClient.invalidateQueries(['streak']);
queryClient.invalidateQueries(['cards_today']);

// –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è ‚Üí –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë
switchProfile(newProfileId);
queryClient.clear();
queryClient.setQueryData(['active_profile'], newProfile);
```

**Rules:**
- –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ —Ç–µ–≥–∞–º (groups of queries)
- –ù–µ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ (throttle)
- Background refetch, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º UI

### Offline Support (Future)

**–ü–ª–∞–Ω—ã –¥–ª—è v2.0:**

1. **Service Worker:**
   - –ö—ç—à —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Å—Å–µ—Ç–æ–≤
   - Offline fallback —Å—Ç—Ä–∞–Ω–∏—Ü–∞

2. **IndexedDB:**
   - –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è offline –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
   - –û—á–µ—Ä–µ–¥—å pending –∑–∞–ø—Ä–æ—Å–æ–≤

3. **Sync API:**
   - Background sync –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
   - –ö–æ–Ω—Ñ–ª–∏–∫—Ç resolution

---

## –ê–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

### Page Transitions

**–¢–∏–ø—ã –∞–Ω–∏–º–∞—Ü–∏–π:**

1. **Slide (–¥–ª—è forward navigation):**
   ```
   Current page: slide left + fade out
   New page: slide in from right + fade in
   Duration: 300ms
   ```

2. **Slide back (for back navigation):**
   ```
   Current page: slide right + fade out
   Previous page: slide in from left + fade in
   Duration: 300ms
   ```

3. **Fade (–¥–ª—è —Å–º–µ–Ω—ã tab):**
   ```
   Current tab: fade out
   New tab: fade in
   Duration: 200ms
   ```

4. **Modal (–¥–ª—è bottom sheets):**
   ```
   Backdrop: fade in
   Sheet: slide up from bottom
   Duration: 250ms
   Easing: ease-out
   ```

### Gestures

**Swipe navigation:**

1. **Swipe right ‚Üí back:**
   - –í —Ä–µ–∂–∏–º–µ –¥–µ—Ç–∞–ª–µ–π (–∫–æ–ª–æ–¥–∞, —Ç–µ–º–∞, –≥—Ä—É–ø–ø–∞)
   - Threshold: 50% —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞ –∏–ª–∏ velocity > 0.3
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å progress indicator –≤–æ –≤—Ä–µ–º—è swipe

2. **Swipe between tabs:**
   - Horizontal swipe –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–∞–±–æ–≤
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–µ–≤—å—é —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–∞–±–∞

3. **Swipe to dismiss modal:**
   - Drag down –Ω–∞ bottom sheet
   - Threshold: 30% –≤—ã—Å–æ—Ç—ã –º–æ–¥–∞–ª–∞
   - Spring animation

**–û—Ç–∫–ª—é—á–∏—Ç—å swipe:**
- –í —Ä–µ–∂–∏–º–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ (–∫–∞—Ä—Ç–æ—á–∫–∏/—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è)
- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç—ã—Ö input –ø–æ–ª—è—Ö
- –í–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏

---

## Accessibility

### Keyboard Navigation

**Tab order:**
- –õ–æ–≥–∏—á–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: top ‚Üí bottom, left ‚Üí right
- Skip links –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É
- Focus trap –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö

**Shortcuts:**
```
Escape ‚Üí –∑–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
Enter ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ
Space ‚Üí –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É (–≤ —Ä–µ–∂–∏–º–µ –∏–∑—É—á–µ–Ω–∏—è)
Arrow Left/Right ‚Üí –Ω–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
```

### Screen Reader

**ARIA labels:**
- –í—Å–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç aria-label
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ aria-live regions
- –†–æ–ª–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è (aria-current, aria-expanded)

**Announcements:**
```
"–ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞" ‚Üí aria-live="polite"
"–û—à–∏–±–∫–∞ —Å–µ—Ç–∏" ‚Üí aria-live="assertive"
"–ó–∞–≥—Ä—É–∑–∫–∞..." ‚Üí aria-busy="true"
```

### Focus Management

**–ü–æ—Å–ª–µ navigation:**
- Focus –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (h1)
- –í –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö ‚Üí focus –Ω–∞ –ø–µ—Ä–≤—ã–π input –∏–ª–∏ –∫–Ω–æ–ø–∫—É
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—Ç focus –Ω–∞ trigger —ç–ª–µ–º–µ–Ω—Ç

---

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ Telegram Mini App –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —è–∑—ã–∫–æ–≤, –≤–∫–ª—é—á–∞—è routing, deep links, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–æ—Ç–æ–º, state management –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.
