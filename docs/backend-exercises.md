# –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–∫—Ç–∏–∫—É —è–∑—ã–∫–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞–Ω–∏–π. –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ LLM –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–º, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–æ–π.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –ª–µ—Ç—É (–Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (CEFR: A1-C2)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ LLM —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–µ–º–∞–º (–≥—Ä–∞–º–º–∞—Ç–∏–∫–∞, –ª–µ–∫—Å–∏–∫–∞, —Å–∏—Ç—É–∞—Ü–∏–∏)

**–õ–∏–º–∏—Ç—ã:**
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: 10 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π/–¥–µ–Ω—å
- –ü—Ä–µ–º–∏—É–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –í—Ö–æ–¥—è—Ç –≤ –æ–±—â–∏–π –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ LLM

---

## –¢–∏–ø—ã —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

### 1. –°–≤–æ–±–æ–¥–Ω—ã–π –≤–≤–æ–¥ (Free Text)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –æ—Ç–≤–µ—Ç —Ç–µ–∫—Å—Ç–æ–º –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ LLM.

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–¥–∞—á:**
- –ü–µ—Ä–µ–≤–æ–¥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤
- –ì—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏, –ø–∞–¥–µ–∂–∞)
- –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ –æ–±—Ä–∞–∑—Ü—É

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
interface FreeTextExercise {
  id: string;
  topic_id: string;
  type: "free_text";

  // –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
  question: string;           // "–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ –∏—Å–ø–∞–Ω—Å–∫–∏–π:"
  prompt: string;             // "–Ø —Ä–∞–±–æ—Ç–∞–ª –≤ —ç—Ç–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –¥–≤–∞ –≥–æ–¥–∞"
  correct_answer: string;     // "He trabajado en esta empresa dos a√±os"

  // –ü–æ–¥—Å–∫–∞–∑–∫–∏ –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
  hint: string | null;        // "–ü–æ–¥—É–º–∞–π—Ç–µ, —Å–≤—è–∑–∞–Ω–æ –ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ —Å –Ω–∞—Å—Ç–æ—è—â–∏–º?"
  explanation: string;        // –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
  alternatives: string[];     // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

  // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  metadata: {
    difficulty: "easy" | "medium" | "hard";
    grammar_points: string[];  // ["pret√©rito_perfecto", "tiempo"]
  };
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ì–∏–±–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ LLM
- –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å–∏–Ω–æ–Ω–∏–º—ã –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ñ–æ—Ä–º—ã
- –î–æ–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∏–µ –æ–ø–µ—á–∞—Ç–∫–∏ (1-2 —Å–∏–º–≤–æ–ª–∞)
- –û—Ü–µ–Ω–∫–∞: `correct` (100%), `partial` (50-99%), `incorrect` (0%)

**–ü—Ä–∏–º–µ—Ä:**
```
–í–æ–ø—Ä–æ—Å: –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ –∏—Å–ø–∞–Ω—Å–∫–∏–π:
–ó–∞–¥–∞–Ω–∏–µ: –Ø —Ä–∞–±–æ—Ç–∞–ª –≤ —ç—Ç–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –¥–≤–∞ –≥–æ–¥–∞

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: "He trabajado en esta empresa dos a√±os"
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã: ["Trabaj√© en esta empresa dos a√±os"]

–û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: "He trabajado en este empresa dos a√±os"
–†–µ–∑—É–ª—å—Ç–∞—Ç: PARTIAL (–æ–ø–µ—á–∞—Ç–∫–∞ "este" –≤–º–µ—Å—Ç–æ "esta")
–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å: "–ü–æ—á—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ä–æ–¥ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ:
'la empresa' (–∂–µ–Ω—Å–∫–∏–π —Ä–æ–¥), –ø–æ—ç—Ç–æ–º—É 'esta empresa'."
```

---

### 2. –í—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ (Multiple Choice)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –æ–¥–∏–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏–∑ 4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
interface MultipleChoiceExercise {
  id: string;
  topic_id: string;
  type: "multiple_choice";

  // –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
  question: string;           // "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ñ–æ—Ä–º—É –≥–ª–∞–≥–æ–ª–∞:"
  prompt: string;             // "Yo ____ en esta empresa dos a√±os"
  options: string[];          // 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞
  correct_index: number;      // –ò–Ω–¥–µ–∫—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (0-3)

  // –û–±—ä—è—Å–Ω–µ–Ω–∏–µ
  explanation: string;        // –ü–æ—á–µ–º—É —ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
  option_explanations: {      // –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞
    [index: number]: string;
  };

  // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  metadata: {
    difficulty: "easy" | "medium" | "hard";
    grammar_points: string[];
  };
}
```

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:**

1. **–û–¥–∏–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç**
2. **–¢—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö (distractor):**
   - –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞
   - –ë–ª–∏–∑–∫–∏–µ –ø–æ —Ñ–æ—Ä–º–µ, –Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
   - –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ü—Ä–∏–º–µ—Ä:**
```
–í–æ–ø—Ä–æ—Å: –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ñ–æ—Ä–º—É –≥–ª–∞–≥–æ–ª–∞:
–ó–∞–¥–∞–Ω–∏–µ: Yo ____ en esta empresa dos a√±os

–í–∞—Ä–∏–∞–Ω—Ç—ã:
A) trabajo        ‚Üê Presente (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
B) trabaj√©        ‚Üê Pret√©rito Indefinido (–≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–æ, –Ω–æ –Ω–µ –ª—É—á—à–∏–π –≤—ã–±–æ—Ä)
C) he trabajado   ‚Üê Pret√©rito Perfecto (–ü–†–ê–í–ò–õ–¨–ù–û)
D) trabajaba      ‚Üê Pret√©rito Imperfecto (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: C
–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: "–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Pret√©rito Perfecto, —Ç–∞–∫ –∫–∞–∫ –¥–µ–π—Å—Ç–≤–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å
–Ω–∞—Å—Ç–æ—è—â–∏–º (–¥–≤–∞ –≥–æ–¥–∞ = –¥–æ —Å–∏—Ö –ø–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–ª–∏ –Ω–µ–¥–∞–≤–Ω–æ –ø–µ—Ä–µ—Å—Ç–∞–ª)."
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞)
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- –ü–æ–∫–∞–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

---

### 3. –ü–µ—Ä–µ–≤–æ–¥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

**–¢–∏–ø:** Free Text

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ç–∏–ø —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤–≤–æ–¥–∞, —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥–µ.

**–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –° —Ä—É—Å—Å–∫–æ–≥–æ –Ω–∞ –∏–∑—É—á–∞–µ–º—ã–π —è–∑—ã–∫ (–æ—Å–Ω–æ–≤–Ω–æ–π)
- –° –∏–∑—É—á–∞–µ–º–æ–≥–æ –Ω–∞ —Ä—É—Å—Å–∫–∏–π (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏
- –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç (—Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å, —Å—Ç–∏–ª—å)
- –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–∞

**–ü—Ä–∏–º–µ—Ä:**
```
–í–æ–ø—Ä–æ—Å: –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ –Ω–µ–º–µ—Ü–∫–∏–π:
–ó–∞–¥–∞–Ω–∏–µ: –Ø —Ö–æ—á—É –∫—É–ø–∏—Ç—å —ç—Ç–æ—Ç –¥–æ–º

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:
- "Ich m√∂chte dieses Haus kaufen"
- "Ich will dieses Haus kaufen"
- "Ich w√ºrde gerne dieses Haus kaufen"

–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å:
"–í—Å–µ —Ç—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã, –Ω–æ 'm√∂chte' –±–æ–ª–µ–µ –≤–µ–∂–ª–∏–≤–∞—è —Ñ–æ—Ä–º–∞,
'will' –±–æ–ª–µ–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—á–Ω–∞—è, 'w√ºrde gerne' —Å–∞–º–∞—è –≤–µ–∂–ª–∏–≤–∞—è."
```

---

### 4. –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π (Word Order)

**–¢–∏–ø:** Free Text –∏–ª–∏ Multiple Choice

**–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—Å—Ç–∞–≤–∏—Ç—å —Å–ª–æ–≤–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ (Free Text):**
```typescript
interface WordOrderExercise {
  question: string;           // "–°–æ—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —Å–ª–æ–≤:"
  words: string[];            // ["casa", "mi", "es", "tu", "casa"]
  correct_answer: string;     // "Mi casa es tu casa"
  hints: {
    word: string;
    position: number;         // –ü–æ–¥—Å–∫–∞–∑–∫–∞: "casa" –Ω–∞ –ø–µ—Ä–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
  }[];
}
```

**–ü—Ä–∏–º–µ—Ä:**
```
–í–æ–ø—Ä–æ—Å: –°–æ—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —Å–ª–æ–≤:
–°–ª–æ–≤–∞: [casa, mi, es, tu, casa]

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: "Mi casa es tu casa"
–ü–æ–¥—Å–∫–∞–∑–∫–∞ (–µ—Å–ª–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–∞): "–ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–∏—Ç—è–∂–∞—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è"
```

---

### 5. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ (Fill in the Blanks)

**–¢–∏–ø:** Free Text

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
interface FillBlanksExercise {
  question: string;           // "–í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞:"
  text_with_blanks: string;   // "Yo ____ en esta empresa ____ a√±os"
  missing_words: string[];    // ["trabajo", "dos"]
  blank_positions: number[];  // –ò–Ω–¥–µ–∫—Å—ã –ø—Ä–æ–ø—É—Å–∫–æ–≤
  context: string | null;     // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
}
```

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**
- –û–¥–∏–Ω –ø—Ä–æ–ø—É—Å–∫ (–ø—Ä–æ—â–µ)
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∏ (—Å–ª–æ–∂–Ω–µ–µ)
- –° –ø–æ–¥—Å–∫–∞–∑–∫–æ–π (–Ω–∞—á–∞–ª—å–Ω–∞—è –±—É–∫–≤–∞)
- –ë–µ–∑ –ø–æ–¥—Å–∫–∞–∑–∫–∏

**–ü—Ä–∏–º–µ—Ä:**
```
–í–æ–ø—Ä–æ—Å: –í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã –≥–ª–∞–≥–æ–ª–æ–≤:
–¢–µ–∫—Å—Ç: "Ayer yo ____ (ir) al mercado y ____ (comprar) frutas"

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: "fui" –∏ "compr√©"
–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å: "–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û–±–∞ –≥–ª–∞–≥–æ–ª–∞ –≤ Pret√©rito Indefinido, —Ç–∞–∫ –∫–∞–∫
–¥–µ–π—Å—Ç–≤–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã –≤ –ø—Ä–æ—à–ª–æ–º (ayer)."
```

---

### 6. –ì—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–¢–∏–ø:** Free Text

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–≤—Ä–µ–º—è, –∑–∞–ª–æ–≥, —á–∏—Å–ª–æ –∏ —Ç.–¥.).

**–¢–∏–ø—ã —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π:**

1. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏:**
   ```
   –î–∞–Ω–æ: "Yo trabajo en una oficina" (Presente)
   –ó–∞–¥–∞–Ω–∏–µ: –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ Pret√©rito Perfecto
   –û—Ç–≤–µ—Ç: "Yo he trabajado en una oficina"
   ```

2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —á–∏—Å–ª–∞:**
   ```
   –î–∞–Ω–æ: "El ni√±o come manzanas"
   –ó–∞–¥–∞–Ω–∏–µ: –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ
   –û—Ç–≤–µ—Ç: "Los ni√±os comen manzanas"
   ```

3. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–ª–æ–≥–∞:**
   ```
   –î–∞–Ω–æ: "Construyeron la casa" (–∞–∫—Ç–∏–≤–Ω—ã–π)
   –ó–∞–¥–∞–Ω–∏–µ: –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –ø–∞—Å—Å–∏–≤–Ω—ã–π –∑–∞–ª–æ–≥
   –û—Ç–≤–µ—Ç: "La casa fue construida"
   ```

4. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–¥–∞:**
   ```
   –î–∞–Ω–æ: "Der gro√üe Hund" (–Ω–µ–º–µ—Ü–∫–∏–π, –º—É–∂—Å–∫–æ–π —Ä–æ–¥)
   –ó–∞–¥–∞–Ω–∏–µ: –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –∂–µ–Ω—Å–∫–∏–π —Ä–æ–¥
   –û—Ç–≤–µ—Ç: "Die gro√üe H√ºndin"
   ```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
interface TransformationExercise {
  question: string;                    // "–ò–∑–º–µ–Ω–∏—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:"
  original_sentence: string;           // –ò—Å—Ö–æ–¥–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
  transformation_type: string;         // "tense_change", "number_change", etc.
  transformation_instruction: string;  // "–Ω–∞ Pret√©rito Perfecto"
  correct_answer: string;
  explanation: string;
}
```

---

### 7. –ê—É–¥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–ª—è v2.0

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –∞—É–¥–∏–æ –∏ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã.

**–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
interface ListeningExercise {
  question: string;
  audio_url: string;          // URL –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞
  audio_duration: number;     // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
  transcript: string;         // –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç (—Å–∫—Ä—ã—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
  questions: {
    text: string;
    type: "multiple_choice" | "free_text";
    correct_answer: string;
  }[];
  play_count_limit: number;   // –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –º–æ–∂–Ω–æ –ø—Ä–æ—Å–ª—É—à–∞—Ç—å
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –Ω–∞ –∞—É–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è –¥–ª—è v2.0.

---

### –¢–∏–ø—ã —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π - –†–µ–∑—é–º–µ

| –¢–∏–ø | –ü—Ä–æ–≤–µ—Ä–∫–∞ | –°–ª–æ–∂–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ | –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å |
|-----|----------|---------------------|-------------|
| Free Text | LLM | –°—Ä–µ–¥–Ω—è—è | v1.0 |
| Multiple Choice | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è | –í—ã—Å–æ–∫–∞—è (–Ω—É–∂–Ω—ã distractor'—ã) | v1.0 |
| Word Order | LLM / –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è | –°—Ä–µ–¥–Ω—è—è | v1.0 (–∫–∞–∫ Free Text) |
| Fill in Blanks | LLM | –°—Ä–µ–¥–Ω—è—è | v1.0 (–∫–∞–∫ Free Text) |
| Transformations | LLM | –°—Ä–µ–¥–Ω—è—è | v1.0 (–∫–∞–∫ Free Text) |
| Listening | LLM | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è | v2.0 |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í v1.0 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–∞:
1. **Free Text** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ç–∏–ø, –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–≤–æ–¥, –ø—Ä–æ–ø—É—Å–∫–∏, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
2. **Multiple Choice** - –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–∏–ø —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π

## –°–æ–∑–¥–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ LLM

–í—Å–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ LLM –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### –ü—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞:**
```python
POST /api/exercises/generate
{
  "topic_id": "uuid",
  "type": "free_text" | "multiple_choice"
}
```

**2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- –¢–µ–º–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (name, description, type)
- –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—è–∑—ã–∫, —É—Ä–æ–≤–µ–Ω—å, —Ü–µ–ª–∏)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–µ–º–µ (accuracy, past exercises)

**3. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞:**

**–î–ª—è Free Text —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π:**
```jinja2
Generate a {{ type }} exercise for the topic: "{{ topic_name }}"

Topic description: {{ topic_description }}
Topic type: {{ topic_type }}  # grammar, vocabulary, situation
Student level: {{ level }}      # A1-C2
Language: {{ language }}

Requirements:
1. Create a clear question/instruction in Russian
2. Provide a prompt (sentence to translate or complete)
3. Difficulty should match {{ level }} level
4. Focus on {{ topic_type }}

{% if topic_type == 'grammar' %}
- Test specific grammar rule: {{ topic_name }}
- Provide context that makes the rule necessary
{% elif topic_type == 'vocabulary' %}
- Use words from the theme: {{ topic_name }}
- Include practical, real-world context
{% elif topic_type == 'situation' %}
- Create realistic scenario: {{ topic_name }}
- Use appropriate register and style
{% endif %}

Respond in JSON format:
{
  "question": "–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ {{ language }}:",
  "prompt": "–Ø —Ä–∞–±–æ—Ç–∞–ª –≤ —ç—Ç–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –¥–≤–∞ –≥–æ–¥–∞",
  "correct_answer": "He trabajado en esta empresa dos a√±os",
  "hint": "Think about whether the action is connected to the present",
  "explanation": "Use Pret√©rito Perfecto because...",
  "alternatives": ["Trabaj√© en esta empresa dos a√±os"],
  "metadata": {
    "difficulty": "medium",
    "grammar_points": ["pret√©rito_perfecto"]
  }
}
```

**–î–ª—è Multiple Choice —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π:**
```jinja2
Generate a multiple choice exercise for the topic: "{{ topic_name }}"

[Same context as above]

Requirements:
1. Create question and prompt
2. Generate 4 options:
   - 1 correct answer
   - 3 plausible but incorrect distractors
3. Distractors should be common mistakes for this rule/level
4. Provide explanations for ALL options

Respond in JSON format:
{
  "question": "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ñ–æ—Ä–º—É –≥–ª–∞–≥–æ–ª–∞:",
  "prompt": "Yo ____ en esta empresa dos a√±os",
  "options": [
    "trabajo",
    "trabaj√©",
    "he trabajado",
    "trabajaba"
  ],
  "correct_index": 2,
  "explanation": "Pret√©rito Perfecto is used because...",
  "option_explanations": {
    "0": "Presente - incorrect for past action",
    "1": "Pret√©rito Indefinido - grammatically correct but...",
    "2": "Pret√©rito Perfecto - CORRECT",
    "3": "Pret√©rito Imperfecto - incorrect for completed action"
  },
  "metadata": {
    "difficulty": "medium",
    "grammar_points": ["pret√©rito_perfecto"]
  }
}
```

**4. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞:**
```python
async def generate_exercise(
    topic: Topic,
    profile: LanguageProfile,
    exercise_type: str
) -> Exercise:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ LLM.
    """
    # 1. –†–µ–Ω–¥–µ—Ä–∏–º –ø—Ä–æ–º–ø—Ç
    prompt = render_exercise_prompt(
        topic=topic,
        profile=profile,
        exercise_type=exercise_type
    )

    # 2. –í—ã–∑—ã–≤–∞–µ–º LLM
    response = await llm_service.chat(
        messages=[
            {'role': 'system', 'content': get_system_prompt(profile)},
            {'role': 'user', 'content': prompt}
        ],
        response_format={'type': 'json_object'},
        temperature=0.8  # –í—ã—Å–æ–∫–∞—è –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
    )

    # 3. –ü–∞—Ä—Å–∏–º –∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ–º
    exercise_data = json.loads(response)
    exercise = Exercise.parse_obj(exercise_data)

    # 4. –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
    validate_exercise(exercise, topic, profile)

    return exercise
```

**5. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ù–ï –∫—ç—à–∏—Ä—É—é—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑.

---

#### –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

**–§–∞–∫—Ç–æ—Ä—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å:**

1. **–£—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (CEFR):**
   - A1-A2: –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –±–∞–∑–æ–≤–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞
   - B1-B2: –°—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å, —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
   - C1-C2: –°–ª–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∏–¥–∏–æ–º—ã, –Ω—é–∞–Ω—Å—ã

2. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–µ–º–µ:**
   ```python
   if topic.accuracy < 0.5:
       difficulty = "easy"  # –£–ø—Ä–æ—Å—Ç–∏—Ç—å
   elif topic.accuracy > 0.85:
       difficulty = "hard"  # –£—Å–ª–æ–∂–Ω–∏—Ç—å
   else:
       difficulty = "medium"
   ```

3. **–¢–∏–ø —Ç–µ–º—ã:**
   - Grammar: –§–æ–∫—É—Å –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º
   - Vocabulary: –§–æ–∫—É—Å –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
   - Situation: –§–æ–∫—É—Å –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∏–ª–µ

**–ü—Ä–∏–º–µ—Ä—ã –∞–¥–∞–ø—Ç–∞—Ü–∏–∏:**

**A1 —É—Ä–æ–≤–µ–Ω—å (Pret√©rito Perfecto):**
```
–í–æ–ø—Ä–æ—Å: –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ –∏—Å–ø–∞–Ω—Å–∫–∏–π:
–ó–∞–¥–∞–Ω–∏–µ: –Ø –µ–ª —è–±–ª–æ–∫–æ
–û—Ç–≤–µ—Ç: He comido una manzana
```

**B2 —É—Ä–æ–≤–µ–Ω—å (Pret√©rito Perfecto):**
```
–í–æ–ø—Ä–æ—Å: –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ –∏—Å–ø–∞–Ω—Å–∫–∏–π:
–ó–∞–¥–∞–Ω–∏–µ: –Ø —É–∂–µ –∑–∞–∫–æ–Ω—á–∏–ª –æ—Ç—á–µ—Ç, –Ω–æ –µ—â–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª –µ–≥–æ –∫–ª–∏–µ–Ω—Ç—É
–û—Ç–≤–µ—Ç: Ya he terminado el informe, pero todav√≠a no lo he enviado al cliente
```

**C1 —É—Ä–æ–≤–µ–Ω—å (Pret√©rito Perfecto):**
```
–í–æ–ø—Ä–æ—Å: –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ –∏—Å–ø–∞–Ω—Å–∫–∏–π:
–ó–∞–¥–∞–Ω–∏–µ: –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–∞ –≥–æ–¥–∞ –º—ã –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å—à–∏—Ä–∏–ª–∏ –Ω–∞—à—É –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
        –Ω–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–º —Ä—ã–Ω–∫–µ, —Ö–æ—Ç—è –∏ —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏
–û—Ç–≤–µ—Ç: En los √∫ltimos dos a√±os hemos ampliado considerablemente nuestra
       actividad en el mercado internacional, aunque hemos enfrentado algunas
       dificultades
```

---

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —É—á–∏—Ç–µ–ª–µ–º (–≥—Ä—É–ø–ø—ã)

**–î–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –≥—Ä—É–ø–ø** –¥–æ—Å—Ç—É–ø–µ–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–º –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.

#### –ü—Ä–æ—Ü–µ—Å—Å

**1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–º—ã —á–µ—Ä–µ–∑ Mini App:**
```
–®–∞–≥–∏:
1. –û—Ç–∫—Ä—ã—Ç—å Mini App ‚Üí –ì—Ä—É–ø–ø—ã ‚Üí –ú–æ—è –≥—Ä—É–ø–ø–∞
2. –ù–∞–∂–∞—Ç—å "–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–º—É"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É:
   - –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã
   - –û–ø–∏—Å–∞–Ω–∏–µ
   - –¢–∏–ø (grammar/vocabulary/situation)
4. –í—ã–±—Ä–∞—Ç—å –≥—Ä—É–ø–ø—ã –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
```

**2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ:**
- –¢–µ–º–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫ —Ç–µ–º –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥—Ä—É–ø–ø—ã
- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- –¢–µ–º–∞ –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ "–≥—Ä—É–ø–ø–æ–≤–∞—è" (üë• –∑–Ω–∞—á–æ–∫)

**3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π:**
- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –º–æ–≥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–æ –≥—Ä—É–ø–ø–æ–≤–æ–π —Ç–µ–º–µ
- –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ —É—Ä–æ–≤–µ–Ω—å –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ
- –í–ª–∞–¥–µ–ª–µ—Ü –≤–∏–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–ü—Ä–æ–≥—Ä–µ—Å—Å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤"

**–ü—Ä–∏–º–µ—Ä:**
```
–í–ª–∞–¥–µ–ª–µ—Ü —Å–æ–∑–¥–∞–µ—Ç —Ç–µ–º—É: "–ê—Ä—Ç–∏–∫–ª–∏ –≤ –Ω–µ–º–µ—Ü–∫–æ–º"
–û–ø–∏—Å–∞–Ω–∏–µ: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∞—Ä—Ç–∏–∫–ª–µ–π"
–¢–∏–ø: grammar

–£—á–∞—Å—Ç–Ω–∏–∫ (A2): –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–æ—Å—Ç—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
  "Der, die –∏–ª–∏ das? ___ Haus"

–£—á–∞—Å—Ç–Ω–∏–∫ (B2): –ø–æ–ª—É—á–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
  "–í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∞—Ä—Ç–∏–∫–ª–∏: ___ Besuch ___ Freundes war ___ gro√üe √úberraschung"
```

---

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑ –¥–∏–∞–ª–æ–≥–∞ "–Ω–∞ –ª–µ—Ç—É"

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ë–æ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –ø–æ —Ö–æ–¥—É —Ä–∞–∑–≥–æ–≤–æ—Ä–∞.

#### –¢—Ä–∏–≥–≥–µ—Ä—ã

**1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç –æ—à–∏–±–∫—É:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "Yo trabaj√© en esta empresa dos a√±os" (–∫–æ–Ω—Ç–µ–∫—Å—Ç - —Å–µ–π—á–∞—Å)
–ë–æ—Ç: "–ü–æ—á—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –í –¥–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Pret√©rito Perfecto:
     'He trabajado'. –•–æ—Ç–∏—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ —ç—Ç—É —Ç–µ–º—É?"

–ö–Ω–æ–ø–∫–∏: [–î–∞, –¥–∞–≤–∞–π] [–ù–µ—Ç, —Å–ø–∞—Å–∏–±–æ]
```

**2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ–± –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–û–±—ä—è—Å–Ω–∏, –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ser –∏ estar"
–ë–æ—Ç: [–û–±—ä—è—Å–Ω–µ–Ω–∏–µ...]
     "–•–æ—Ç–∏—Ç–µ –∑–∞–∫—Ä–µ–ø–∏—Ç—å —ç—Ç–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ–º?"

–ö–Ω–æ–ø–∫–∏: [–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ]
```

**3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ —Ç–µ–º–µ:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–î–æ–±–∞–≤—å —Å–ª–æ–≤–∞: comer, beber, dormir"
–ë–æ—Ç: "–î–æ–±–∞–≤–∏–ª 3 –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –≥–ª–∞–≥–æ–ª–∞–º–∏! –•–æ—Ç–∏—Ç–µ –ø–æ–ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å –∏—Ö –≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è—Ö?"

–ö–Ω–æ–ø–∫–∏: [–î–∞, —Å–æ–∑–¥–∞–π —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ]
```

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

**1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è:**
```python
# –í –¥–∏–∞–ª–æ–≥–µ –±–æ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç
conversation_context = {
    'last_topic': 'pret√©rito_perfecto',
    'last_error': {
        'type': 'grammar',
        'rule': 'tense_usage'
    },
    'suggested_exercise': False
}

# –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç –æ—à–∏–±–∫—É, –ø–æ–º–µ—á–∞–µ–º
if detect_error(user_message):
    conversation_context['suggested_exercise'] = True
    return offer_exercise(error_type='tense_usage')
```

**2. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:**
```python
async def offer_exercise(error_type: str) -> BotResponse:
    """
    –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—à–∏–±–∫–∏.
    """
    message = "–•–æ—Ç–∏—Ç–µ –ø–æ–ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å —ç—Ç–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ–º?"

    return BotResponse(
        text=message,
        inline_keyboard=[
            [{'text': '–î–∞, –¥–∞–≤–∞–π', 'callback_data': f'exercise:generate:{error_type}'}],
            [{'text': '–ù–µ—Ç, —Å–ø–∞—Å–∏–±–æ', 'callback_data': 'exercise:skip'}]
        ]
    )
```

**3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:**
```python
async def handle_exercise_callback(callback_data: str, user: User, profile: LanguageProfile):
    """
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "–î–∞, –¥–∞–≤–∞–π".
    """
    if callback_data.startswith('exercise:generate:'):
        error_type = callback_data.split(':')[2]

        # –°–æ–∑–¥–∞–µ–º —Ç–µ–º—É "–Ω–∞ –ª–µ—Ç—É" –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
        topic = await get_or_create_topic_for_error(error_type, profile)

        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
        exercise = await generate_exercise(topic, profile, 'free_text')

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
        return await send_exercise(user, exercise)
```

**4. –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
```python
# –ï—Å–ª–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ "–Ω–∞ –ª–µ—Ç—É", —Å–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ç–µ–º—É
# –∏–ª–∏ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π

# –û–ø—Ü–∏—è 1: –í—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–µ–º–∞
temp_topic = Topic(
    name=f"–ü—Ä–∞–∫—Ç–∏–∫–∞: {error_type}",
    type='grammar',
    is_temporary=True,  # –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    ...
)

# –û–ø—Ü–∏—è 2: –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ç–µ–º–µ
existing_topic = await find_matching_topic(error_type, profile)
if existing_topic:
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
    topic = existing_topic
else:
    # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é —Ç–µ–º—É
    return offer_create_topic(error_type)
```

---

### –†–µ–∑—é–º–µ: –°–ø–æ—Å–æ–±—ã —Å–æ–∑–¥–∞–Ω–∏—è

| –°–ø–æ—Å–æ–± | –ö—Ç–æ —Å–æ–∑–¥–∞–µ—Ç | –ö–æ–≥–¥–∞ | –•—Ä–∞–Ω–µ–Ω–∏–µ |
|--------|-------------|-------|----------|
| LLM –≥–µ–Ω–µ—Ä–∞—Ü–∏—è | –°–∏—Å—Ç–µ–º–∞ | –ü–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ù–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |
| –°–æ–∑–¥–∞–Ω–∏–µ —É—á–∏—Ç–µ–ª–µ–º | –í–ª–∞–¥–µ–ª–µ—Ü –≥—Ä—É–ø–ø—ã | –ß–µ—Ä–µ–∑ Mini App | –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –≤ –ë–î |
| –ò–∑ –¥–∏–∞–ª–æ–≥–∞ | –°–∏—Å—Ç–µ–º–∞ (–ø–æ —Ç—Ä–∏–≥–≥–µ—Ä—É) | –í–æ –≤—Ä–µ–º—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ | –í—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–µ–º–∞ –∏–ª–∏ –ø—Ä–∏–≤—è–∑–∫–∞ |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í—Å–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ - —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–µ–º–∞, –∞ —Å–∞–º–æ –∑–∞–¥–∞–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ LLM –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–Ω–æ–≤–æ.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (Multiple Choice)

**–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è:** Multiple Choice —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

**–ü—Ä–æ—Ü–µ—Å—Å:**

**1. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞:**
```python
POST /api/exercises/{exercise_id}/submit
{
  "answer": 2,        # –ò–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ (0-3)
  "used_hint": false  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ª–∏ –ø–æ–¥—Å–∫–∞–∑–∫—É
}
```

**2. –í–∞–ª–∏–¥–∞—Ü–∏—è:**
```python
async def check_multiple_choice(
    exercise: Exercise,
    user_answer_index: int
) -> ExerciseResult:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ Multiple Choice —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ.
    """
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∏–Ω–¥–µ–∫—Å–∞
    if not (0 <= user_answer_index < len(exercise.options)):
        raise ValidationError("Invalid answer index")

    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º
    is_correct = user_answer_index == exercise.correct_index

    if is_correct:
        result_type = "correct"
        feedback = "–û—Ç–ª–∏—á–Ω–æ! –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç."
    else:
        result_type = "incorrect"
        feedback = f"–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: {exercise.options[exercise.correct_index]}"

    return ExerciseResult(
        result=result_type,
        correct_answer=exercise.options[exercise.correct_index],
        explanation=exercise.explanation,
        feedback=feedback,
        option_explanations=exercise.option_explanations
    )
```

**3. –û—Ç–≤–µ—Ç:**
```json
{
  "result": "incorrect",
  "correct_answer": "he trabajado",
  "explanation": "–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Pret√©rito Perfecto, —Ç–∞–∫ –∫–∞–∫ –¥–µ–π—Å—Ç–≤–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å –Ω–∞—Å—Ç–æ—è—â–∏–º...",
  "feedback": "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: he trabajado",
  "option_explanations": {
    "0": "Presente - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è",
    "1": "Pret√©rito Indefinido - –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–æ, –Ω–æ –≤ –¥–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ª—É—á—à–µ Pret√©rito Perfecto",
    "2": "Pret√©rito Perfecto - –ü–†–ê–í–ò–õ–¨–ù–û",
    "3": "Pret√©rito Imperfecto - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è"
  }
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–±–µ–∑ LLM)
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥—Ä–∞–¥–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ correct/incorrect)

---

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ LLM (Free Text)

**–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è:** Free Text —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π (–ø–µ—Ä–µ–≤–æ–¥, –ø—Ä–æ–ø—É—Å–∫–∏, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏)

**–ü—Ä–æ—Ü–µ—Å—Å:**

**1. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞:**
```python
POST /api/exercises/{exercise_id}/submit
{
  "answer": "He trabajado en este empresa dos a√±os",
  "used_hint": false
}
```

**2. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```jinja2
Check the student's answer to the exercise.

Exercise:
Question: {{ question }}
Prompt: {{ prompt }}
Correct answer: {{ correct_answer }}
Alternative answers: {{ alternatives | join(', ') }}

Student's answer: {{ user_answer }}
Student level: {{ level }}

Evaluation criteria:
1. Grade as "correct", "partial", or "incorrect"
2. Accept synonyms and alternative correct forms
3. Ignore minor typos (1-2 characters)
4. Consider grammatically correct alternatives
5. Be strict with grammar if it's a grammar exercise
6. Be encouraging but honest

Provide detailed feedback:
- What was right (if anything)
- What was wrong (if anything)
- How to fix it
- Encouragement

Respond in JSON format:
{
  "result": "correct|partial|incorrect",
  "correct_answer": "He trabajado en esta empresa dos a√±os",
  "explanation": "–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Pret√©rito Perfecto...",
  "alternatives": ["Trabaj√© en esta empresa dos a√±os (also correct)"],
  "feedback": "–û—Ç–ª–∏—á–Ω–æ! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è.",
  "mistakes": [
    {
      "type": "grammar",
      "found": "este empresa",
      "correction": "esta empresa",
      "explanation": "–†–æ–¥ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ: 'la empresa' (–∂–µ–Ω—Å–∫–∏–π —Ä–æ–¥)"
    }
  ]
}
```

**3. –í—ã–∑–æ–≤ LLM:**
```python
async def check_free_text_answer(
    exercise: Exercise,
    user_answer: str,
    profile: LanguageProfile
) -> ExerciseResult:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–π –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ LLM.
    """
    # 1. –†–µ–Ω–¥–µ—Ä–∏–º –ø—Ä–æ–º–ø—Ç
    prompt = render_check_prompt(
        exercise=exercise,
        user_answer=user_answer,
        profile=profile
    )

    # 2. –í—ã–∑—ã–≤–∞–µ–º LLM
    response = await llm_service.chat(
        messages=[
            {'role': 'system', 'content': get_system_prompt(profile)},
            {'role': 'user', 'content': prompt}
        ],
        response_format={'type': 'json_object'},
        temperature=0.3  # –ù–∏–∑–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏
    )

    # 3. –ü–∞—Ä—Å–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    result = ExerciseResult.parse_obj(json.loads(response))

    # 4. –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞
    result = post_process_result(result, exercise, user_answer)

    return result
```

**4. –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞:**
```python
def post_process_result(
    result: ExerciseResult,
    exercise: Exercise,
    user_answer: str
) -> ExerciseResult:
    """
    –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏.
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ LLM –Ω–µ —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥
    if result.result == "incorrect":
        # –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –æ—á–µ–Ω—å –±–ª–∏–∑–æ–∫ –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É (Levenshtein distance)
        if is_very_similar(user_answer, exercise.correct_answer):
            # –ü–æ–Ω–∏–∂–∞–µ–º –æ—Ü–µ–Ω–∫—É –¥–æ "partial"
            result.result = "partial"
            result.feedback = "–ü–æ—á—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ! " + result.feedback

    # –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
    if result.result == "correct":
        result.feedback = random.choice([
            "–û—Ç–ª–∏—á–Ω–æ!",
            "–ü—Ä–∞–≤–∏–ª—å–Ω–æ!",
            "–ú–æ–ª–æ–¥–µ—Ü!",
            "–í–µ—Ä–Ω–æ!"
        ]) + " " + result.feedback
    elif result.result == "partial":
        result.feedback = "–•–æ—Ä–æ—à–æ, –Ω–æ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è –æ—à–∏–±–∫–∞. " + result.feedback
    elif result.result == "incorrect":
        result.feedback = "–ù–µ —Å–æ–≤—Å–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ. " + result.feedback

    return result
```

**5. –û—Ç–≤–µ—Ç:**
```json
{
  "result": "partial",
  "correct_answer": "He trabajado en esta empresa dos a√±os",
  "explanation": "–í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Pret√©rito Perfecto, –Ω–æ –µ—Å—Ç—å –æ—à–∏–±–∫–∞ –≤ —Ä–æ–¥–µ.",
  "alternatives": ["Trabaj√© en esta empresa dos a√±os"],
  "feedback": "–•–æ—Ä–æ—à–æ, –Ω–æ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è –æ—à–∏–±–∫–∞. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ä–æ–¥ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ.",
  "mistakes": [
    {
      "type": "grammar",
      "found": "este empresa",
      "correction": "esta empresa",
      "explanation": "'La empresa' (–∂–µ–Ω—Å–∫–∏–π —Ä–æ–¥), –ø–æ—ç—Ç–æ–º—É 'esta empresa'"
    }
  ]
}
```

---

### 3. –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

**1. –û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```typescript
type ExerciseResultType = "correct" | "partial" | "incorrect";

// –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è
const resultColors = {
  correct: "green",    // ‚úÖ
  partial: "orange",   // ‚ö†Ô∏è
  incorrect: "red"     // ‚ùå
};
```

**2. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

```typescript
interface ExerciseResult {
  // –û—Ü–µ–Ω–∫–∞
  result: ExerciseResultType;

  // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
  correct_answer: string;

  // –û—Å–Ω–æ–≤–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
  explanation: string;

  // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
  alternatives: string[];

  // –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
  feedback: string;

  // –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫ (–¥–ª—è Free Text)
  mistakes?: Mistake[];
}

interface Mistake {
  type: "grammar" | "spelling" | "vocabulary" | "style";
  found: string;           // –ß—Ç–æ –Ω–∞–ø–∏—Å–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  correction: string;      // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
  explanation: string;     // –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
}
```

**3. –§–æ—Ä–º–∞—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (Telegram Bot):**

```
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û!

–í–∞—à –æ—Ç–≤–µ—Ç: He trabajado en esta empresa dos a√±os
–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: He trabajado en esta empresa dos a√±os

üìù –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
–û—Ç–ª–∏—á–Ω–æ! –í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Pret√©rito Perfecto, —Ç–∞–∫ –∫–∞–∫ –¥–µ–π—Å—Ç–≤–∏–µ
—Å–≤—è–∑–∞–Ω–æ —Å –Ω–∞—Å—Ç–æ—è—â–∏–º (–¥–≤–∞ –≥–æ–¥–∞ = –¥–æ —Å–∏—Ö –ø–æ—Ä).

üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
‚Ä¢ Trabaj√© en esta empresa dos a√±os (—Ç–æ–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –¥—Ä—É–≥–æ–µ –≤—Ä–µ–º—è)

–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üéâ
```

```
‚ö†Ô∏è –ü–û–ß–¢–ò –ü–†–ê–í–ò–õ–¨–ù–û

–í–∞—à –æ—Ç–≤–µ—Ç: He trabajado en este empresa dos a√±os
–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: He trabajado en esta empresa dos a√±os

‚ùå –û—à–∏–±–∫–∏:
1. –†–æ–¥ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ: "este empresa" ‚Üí "esta empresa"
   'La empresa' (–∂–µ–Ω—Å–∫–∏–π —Ä–æ–¥), –ø–æ—ç—Ç–æ–º—É 'esta empresa'

üìù –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
–í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Pret√©rito Perfecto! –ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–æ–¥.

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑! üí™
```

```
‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û

–í–∞—à –æ—Ç–≤–µ—Ç: Yo trabajo en esta empresa dos a√±os
–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: He trabajado en esta empresa dos a√±os

‚ùå –û—à–∏–±–∫–∏:
1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è: "trabajo" (Presente) ‚Üí "he trabajado" (Pret√©rito Perfecto)
   –î–µ–π—Å—Ç–≤–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å –Ω–∞—Å—Ç–æ—è—â–∏–º (–¥–≤–∞ –≥–æ–¥–∞ = –¥–æ —Å–∏—Ö –ø–æ—Ä)

üìù –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Pret√©rito Perfecto –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—á–∞–ª–∏—Å—å –≤ –ø—Ä–æ—à–ª–æ–º
–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è –∏–ª–∏ —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å.

–§–æ—Ä–º—É–ª–∞: haber (–≤ –Ω–∞—Å—Ç–æ—è—â–µ–º) + participio

–ù–µ —Ä–∞—Å—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ—Å—å, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑! üôÇ
```

**4. –§–æ—Ä–º–∞—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (Mini App):**

–ë–æ–ª–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π UI —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û                     ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ –í–∞—à –æ—Ç–≤–µ—Ç:                       ‚îÇ
‚îÇ He trabajado en esta empresa... ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ [–ü–æ–∫–∞–∑–∞—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ ‚ñº]         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìù –û–±—ä—è—Å–Ω–µ–Ω–∏–µ                    ‚îÇ
‚îÇ –û—Ç–ª–∏—á–Ω–æ! –í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ...         ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:                 ‚îÇ
‚îÇ ‚Ä¢ Trabaj√© en esta empresa...    ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ [–°–ª–µ–¥—É—é—â–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ‚Üí]        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

#### –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

**1. –ü–æ —É—Ä–æ–≤–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**

**A1-A2:**
```
"–û—Ç–ª–∏—á–Ω–æ! –í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è.
–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å!"
```

**C1-C2:**
```
"–û—Ç–ª–∏—á–Ω–æ! –í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Pret√©rito Perfecto,
–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å–≤—è–∑–∏ –¥–µ–π—Å—Ç–≤–∏—è —Å –Ω–∞—Å—Ç–æ—è—â–∏–º –º–æ–º–µ–Ω—Ç–æ–º."
```

**2. –ü–æ —Ç–∏–ø—É –æ—à–∏–±–∫–∏:**

**–ú–µ–ª–∫–∞—è –æ–ø–µ—á–∞—Ç–∫–∞:**
```
"–ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ! –ù–µ–±–æ–ª—å—à–∞—è –æ–ø–µ—á–∞—Ç–∫–∞: 'este' ‚Üí 'esta'."
```

**–ì—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:**
```
"–•–æ—Ä–æ—à–∞—è –ø–æ–ø—ã—Ç–∫–∞! –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤—Ä–µ–º—è –≥–ª–∞–≥–æ–ª–∞:
–≤ –¥–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –Ω—É–∂–µ–Ω Pret√©rito Perfecto."
```

**–ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```
"–ù–µ —Å–æ–≤—Å–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º:
[–¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞]
–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –∑–∞–ø—Ä–æ—Å–∏—Ç–µ –ø–æ–¥—Å–∫–∞–∑–∫—É!"
```

**3. –ü–æ –ø—Ä–æ–≥—Ä–µ—Å—Å—É:**

**–ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞:**
```
"–•–æ—Ä–æ—à–∞—è –ø–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞! [–æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å]"
```

**–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—à–∏–±–∫–∞:**
```
"–í—ã —Å–Ω–æ–≤–∞ –æ—à–∏–±–ª–∏—Å—å –≤ —ç—Ç–æ–º –∂–µ –º–µ—Å—Ç–µ. –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ [—Å—Å—ã–ª–∫–∞]."
```

**–£–ª—É—á—à–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏:**
```
"–û—Ç–ª–∏—á–Ω–æ! –í —ç—Ç–æ—Ç —Ä–∞–∑ –≤—ã –∏—Å–ø—Ä–∞–≤–∏–ª–∏ –æ—à–∏–±–∫—É. –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!"
```

---

### –ü–æ–¥—Å–∫–∞–∑–∫–∏

**–ó–∞–ø—Ä–æ—Å –ø–æ–¥—Å–∫–∞–∑–∫–∏:**
```python
POST /api/exercises/{exercise_id}/hint
```

**–¢–∏–ø—ã –ø–æ–¥—Å–∫–∞–∑–æ–∫:**

**1. –û–±—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ (–ø–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å):**
```
"–ü–æ–¥—É–º–∞–π—Ç–µ, —Å–≤—è–∑–∞–Ω–æ –ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ —Å –Ω–∞—Å—Ç–æ—è—â–∏–º –º–æ–º–µ–Ω—Ç–æ–º?"
```

**2. –ë–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ (–≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å):**
```
"–î–ª—è –¥–µ–π—Å—Ç–≤–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –Ω–∞—Å—Ç–æ—è—â–∏–º, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Pret√©rito Perfecto.
–§–æ—Ä–º—É–ª–∞: haber + participio"
```

**3. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ (—Ç—Ä–µ—Ç–∏–π —É—Ä–æ–≤–µ–Ω—å):**
```
"–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º—É 'he trabajado' (haber –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º + participio)"
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
async def get_hint(
    exercise: Exercise,
    hint_level: int = 1
) -> str:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∫—É –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.
    """
    if hint_level == 1:
        # –û–±—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –∏–∑ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        return exercise.hint

    elif hint_level == 2:
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É —á–µ—Ä–µ–∑ LLM
        prompt = f"""
        Provide a more specific hint for this exercise:
        Question: {exercise.question}
        Prompt: {exercise.prompt}

        The hint should guide towards the correct answer without giving it away.
        """
        return await llm_service.chat([{'role': 'user', 'content': prompt}])

    else:  # hint_level == 3
        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ - –ø–æ—á—Ç–∏ –æ—Ç–≤–µ—Ç
        return f"–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å: {exercise.correct_answer[:10]}..."
```

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –æ—Ü–µ–Ω–∫—É:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Å–Ω–∏–∂–∞–µ—Ç "–Ω–∞–≥—Ä–∞–¥—É" –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞)
- –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (correct/partial/incorrect)

---

### –†–µ–∑—é–º–µ: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤

| –¢–∏–ø —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è | –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ | –°–∫–æ—Ä–æ—Å—Ç—å | –ì–∏–±–∫–æ—Å—Ç—å | –¢–æ—á–Ω–æ—Å—Ç—å |
|----------------|----------------|----------|----------|----------|
| Multiple Choice | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ | –ù–∏–∑–∫–∞—è | 100% |
| Free Text | LLM | 2-5 —Å–µ–∫ | –í—ã—Å–æ–∫–∞—è | 90-95% |

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ LLM –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- –£—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∏–Ω–æ–Ω–∏–º—ã –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
- –ì–∏–±–∫–∞—è –æ—Ü–µ–Ω–∫–∞ (correct/partial/incorrect)
- –î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ
- –î–æ—Ä–æ–∂–µ (—Ç–æ–∫–µ–Ω—ã)
- –ù–µ–±–æ–ª—å—à–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–∫–∏ (~5%)

## –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

### 1. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–µ–º–∞–º

–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –≤–æ–∫—Ä—É–≥ **—Ç–µ–º** (Topics), –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑—É—á–µ–Ω–∏—è.

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ–º—ã

```typescript
interface Topic {
  id: string;
  profile_id: string;
  name: string;              // "Pret√©rito Perfecto"
  description: string;       // "–ü—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –Ω–µ–¥–∞–≤–Ω–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π"
  type: TopicType;           // "grammar" | "vocabulary" | "situation"

  // –ú–µ—Ç—Ä–∏–∫–∏
  exercises_count: number;   // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
  accuracy: number;          // –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ (0.0-1.0)
  stats: {
    correct: number;
    partial: number;
    incorrect: number;
  };

  // –°–æ—Å—Ç–æ—è–Ω–∏–µ
  is_active: boolean;        // –ê–∫—Ç–∏–≤–Ω–∞—è —Ç–µ–º–∞ (–≤–∏–¥–Ω–∞ –≤ Mini App)
  is_group: boolean;         // –¢–µ–º–∞ –∏–∑ –≥—Ä—É–ø–ø—ã
  owner_id?: string;         // –î–ª—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —Ç–µ–º
}
```

#### –¢–∏–ø—ã —Ç–µ–º

**1. Grammar (–ì—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–µ):**
```
–ü—Ä–∏–º–µ—Ä—ã:
- Pret√©rito Perfecto
- –ê—Ä—Ç–∏–∫–ª–∏ –≤ –Ω–µ–º–µ—Ü–∫–æ–º
- Ser vs Estar
- Pass√© Compos√©

–§–æ–∫—É—Å: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª
```

**2. Vocabulary (–õ–µ–∫—Å–∏—á–µ—Å–∫–∏–µ):**
```
–ü—Ä–∏–º–µ—Ä—ã:
- –ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏
- –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è
- –î–µ–ª–æ–≤–∞—è –ª–µ–∫—Å–∏–∫–∞
- –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã

–§–æ–∫—É—Å: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–Ω–æ–≥–æ –∑–∞–ø–∞—Å–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
```

**3. Situation (–°–∏—Ç—É–∞—Ü–∏–æ–Ω–Ω—ã–µ):**
```
–ü—Ä–∏–º–µ—Ä—ã:
- –í —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ
- –ù–∞ —Ä–∞–±–æ—Ç–µ
- –£ –≤—Ä–∞—á–∞
- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–µ–ª—è

–§–æ–∫—É—Å: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö
```

#### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç–µ–º

**1. –°–æ–∑–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º:**
```
- –ß–µ—Ä–µ–∑ –±–æ—Ç–∞: "–°–æ–∑–¥–∞–π —Ç–µ–º—É: –ê—Ä—Ç–∏–∫–ª–∏ –≤ –Ω–µ–º–µ—Ü–∫–æ–º"
- –ß–µ—Ä–µ–∑ Mini App: —Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–º—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π LLM
```

**2. –ì—Ä—É–ø–ø–æ–≤—ã–µ —Ç–µ–º—ã:**
```
- –°–æ–∑–¥–∞–Ω–Ω—ã–µ —É—á–∏—Ç–µ–ª–µ–º –¥–ª—è –≥—Ä—É–ø–ø—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è —É –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –ü–æ–º–µ—á–µ–Ω—ã –∑–Ω–∞—á–∫–æ–º üë•
```

**3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ:**
```
- –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- LLM –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ç–µ–º—ã
- POST /api/topics/suggest
```

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏

**–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–º—ã:**
```python
POST /api/topics
{
  "name": "Pret√©rito Perfecto",
  "description": "–ü—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –Ω–µ–¥–∞–≤–Ω–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π",
  "type": "grammar",
  "profile_id": "uuid"
}
```

**–ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è:**
```python
POST /api/topics/{topic_id}/activate
# is_active = true

# –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ–º—ã —Å–∫—Ä—ã—Ç—ã –≤ Mini App, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –∏—Å—Ç–æ—Ä–∏–µ–π
```

**–£–¥–∞–ª–µ–Ω–∏–µ:**
```python
DELETE /api/topics/{topic_id}
# Soft delete - —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```

---

### 2. –£—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

–°–ª–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤.

#### –§–∞–∫—Ç–æ—Ä—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

**1. –£—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (CEFR):**

```typescript
type CEFRLevel = "A1" | "A2" | "B1" | "B2" | "C1" | "C2";

const difficultyMapping = {
  "A1": { complexity: 1, sentence_length: "short", vocabulary: "basic" },
  "A2": { complexity: 2, sentence_length: "short-medium", vocabulary: "basic-intermediate" },
  "B1": { complexity: 3, sentence_length: "medium", vocabulary: "intermediate" },
  "B2": { complexity: 4, sentence_length: "medium-long", vocabulary: "advanced" },
  "C1": { complexity: 5, sentence_length: "long", vocabulary: "advanced-native" },
  "C2": { complexity: 6, sentence_length: "complex", vocabulary: "native" }
};
```

**2. –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ —Ç–µ–º–µ:**

```python
def calculate_difficulty(topic: Topic, profile: LanguageProfile) -> str:
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏.
    """
    base_level = profile.current_level  # A1-C2

    if topic.exercises_count < 5:
        # –ù–∞—á–∏–Ω–∞–µ–º —Å —É—Ä–æ–≤–Ω—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        return "medium"

    # –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–æ—á–Ω–æ—Å—Ç–∏
    if topic.accuracy < 0.5:
        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–ª–æ—Ö–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è - —É–ø—Ä–æ—â–∞–µ–º
        return "easy"
    elif topic.accuracy > 0.85:
        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è - —É—Å–ª–æ–∂–Ω—è–µ–º
        return "hard"
    else:
        return "medium"
```

**3. –¢–∏–ø —Ç–µ–º—ã:**

```python
difficulty_by_type = {
    "grammar": {
        "easy": "Simple sentences, basic rules",
        "medium": "Complex sentences, exceptions",
        "hard": "Nuanced usage, idiomatic expressions"
    },
    "vocabulary": {
        "easy": "Common words, direct translations",
        "medium": "Contextual usage, collocations",
        "hard": "Idioms, phrasal verbs, synonyms"
    },
    "situation": {
        "easy": "Basic phrases, polite forms",
        "medium": "Natural conversation, register",
        "hard": "Cultural nuances, formal/informal mix"
    }
}
```

#### –ü—Ä–∏–º–µ—Ä—ã –ø–æ —É—Ä–æ–≤–Ω—è–º

**–¢–µ–º–∞: "Pret√©rito Perfecto"**

**Easy (A1-A2 –∏–ª–∏ –Ω–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å):**
```
–ó–∞–¥–∞–Ω–∏–µ: –Ø –µ–ª
–û—Ç–≤–µ—Ç: He comido
```

**Medium (B1-B2 –∏–ª–∏ —Å—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å):**
```
–ó–∞–¥–∞–Ω–∏–µ: –Ø —É–∂–µ –∑–∞–∫–æ–Ω—á–∏–ª —Ä–∞–±–æ—Ç—É
–û—Ç–≤–µ—Ç: Ya he terminado el trabajo
```

**Hard (C1-C2 –∏–ª–∏ –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å):**
```
–ó–∞–¥–∞–Ω–∏–µ: –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã —ç–∫–æ–Ω–æ–º–∏–∫–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏–ª–∞—Å—å,
        —Ö–æ—Ç—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–µ–∫—Ç–æ—Ä–∞ –≤—Å–µ –µ—â–µ –∏—Å–ø—ã—Ç—ã–≤–∞—é—Ç —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏
–û—Ç–≤–µ—Ç: En los √∫ltimos a√±os la econom√≠a ha mejorado considerablemente,
       aunque algunos sectores todav√≠a enfrentan dificultades
```

---

### 3. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

–°–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π.

#### –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏

**–¢–∞–±–ª–∏—Ü–∞: exercise_history**
```sql
CREATE TABLE exercise_history (
  id UUID PRIMARY KEY,
  user_id UUID NOT NULL,
  profile_id UUID NOT NULL,
  topic_id UUID NOT NULL,

  -- –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
  type VARCHAR(50) NOT NULL,         -- free_text, multiple_choice
  question TEXT NOT NULL,
  prompt TEXT NOT NULL,
  correct_answer TEXT NOT NULL,

  -- –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  user_answer TEXT NOT NULL,
  result VARCHAR(20) NOT NULL,       -- correct, partial, incorrect
  explanation TEXT,
  used_hint BOOLEAN DEFAULT false,

  -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  duration_seconds INTEGER,          -- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  metadata JSONB,                    -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

  completed_at TIMESTAMP NOT NULL,
  created_at TIMESTAMP DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_exercise_history_user_profile ON exercise_history(user_id, profile_id);
CREATE INDEX idx_exercise_history_topic ON exercise_history(topic_id);
CREATE INDEX idx_exercise_history_completed ON exercise_history(completed_at);
```

#### –ú–µ—Ç—Ä–∏–∫–∏

**1. –ü–æ —Ç–µ–º–µ:**
```python
GET /api/topics/{topic_id}

Response:
{
  "id": "uuid",
  "name": "Pret√©rito Perfecto",
  "exercises_count": 24,
  "accuracy": 0.79,
  "stats": {
    "correct": 15,
    "partial": 6,
    "incorrect": 3
  },
  "recent_activity": [
    {
      "date": "2025-01-08",
      "exercises_completed": 3,
      "accuracy": 0.67
    }
  ]
}
```

**2. –ü–æ –ø—Ä–æ—Ñ–∏–ª—é:**
```python
GET /api/stats?profile_id=uuid

Response:
{
  "exercises": {
    "total": 48,
    "stats": {
      "correct": 38,
      "partial": 7,
      "incorrect": 3
    },
    "accuracy": 0.79
  },
  "time": {
    "total_minutes": 456,
    "average_per_exercise": 9.5
  },
  "topics": [
    {
      "name": "Pret√©rito Perfecto",
      "exercises_count": 24,
      "accuracy": 0.85
    }
  ]
}
```

**3. –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
```python
GET /api/exercises/history?topic_id=uuid&limit=10

Response:
{
  "data": [
    {
      "id": "uuid",
      "topic_name": "Pret√©rito Perfecto",
      "type": "free_text",
      "question": "–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ –∏—Å–ø–∞–Ω—Å–∫–∏–π:",
      "prompt": "–Ø —Ä–∞–±–æ—Ç–∞–ª –¥–≤–∞ –≥–æ–¥–∞",
      "user_answer": "He trabajado dos a√±os",
      "result": "correct",
      "used_hint": false,
      "duration_seconds": 45,
      "completed_at": "2025-01-08T14:30:00Z"
    }
  ],
  "pagination": {...}
}
```

#### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

**1. –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–∫–∞–ª–µ–Ω–¥–∞—Ä—å):**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Mo  Tu  We  Th  Fr  Sa  Su‚îÇ
‚îÇ 1  üü©  üü©  ‚¨ú  üü©  üü©  ‚¨ú  ‚¨ú‚îÇ
‚îÇ 2  üü©  üü®  üü©  ‚¨ú  üü©  üü©  ‚¨ú‚îÇ
‚îÇ 3  üü©  üü©  üü©  üü©  ‚¨ú  ‚¨ú  ‚¨ú‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

üü© > 5 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
üü® 1-5 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
‚¨ú –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
```

**2. –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Ç–µ–º–∞–º:**
```
Pret√©rito Perfecto    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 85% (24 —É–ø—Ä.)
Ser vs Estar          ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 45% (8 —É–ø—Ä.)
–ê—Ä—Ç–∏–∫–ª–∏               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë 67% (12 —É–ø—Ä.)
```

**3. –°–≤–æ–¥–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥:**
```
–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π:
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:   18 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π (75%)
‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ:    4 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è  (17%)
‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: 2 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è  (8%)

–í—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏: 3—á 15–º–∏–Ω
–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: 8.1 –º–∏–Ω
```

---

### 4. –°–µ—Å—Å–∏–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

**–§–æ—Ä–º–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏—è–º–∏.

**–°–µ—Å—Å–∏—è:**
```typescript
interface ExerciseSession {
  id: string;
  profile_id: string;
  topic_id: string;
  exercises_count: number;   // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –≤ —Å–µ—Å—Å–∏–∏ (5-10)
  completed_count: number;   // –í—ã–ø–æ–ª–Ω–µ–Ω–æ
  started_at: Date;
  completed_at?: Date;
}
```

**–¢–∏–ø–∏—á–Ω–∞—è —Å–µ—Å—Å–∏—è:**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–µ–º—É
2. –°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 5-10 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
4. –í –∫–æ–Ω—Ü–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

**–ü—Ä–∏–º–µ—Ä —Å–≤–æ–¥–∫–∏:**
```
üéâ –°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

–¢–µ–º–∞: Pret√©rito Perfecto
–í—ã–ø–æ–ª–Ω–µ–Ω–æ: 5 –∏–∑ 5 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:   3 (60%)
‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ:    1 (20%)
‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: 1 (20%)

–í—Ä–µ–º—è: 12 –º–∏–Ω 30 —Å–µ–∫

[–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –æ—à–∏–±–æ—á–Ω—ã–µ] [–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è]
```

---

## –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥ —É—Ä–æ–≤–µ–Ω—å –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### 1. –ù–∞—á–∞–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è

**–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è:**
```python
async def initialize_profile(profile: LanguageProfile):
    """
    –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.
    """
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ç–µ–º—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Ä–æ–≤–Ω—è
    initial_topics = await llm_service.suggest_topics(
        level=profile.current_level,
        language=profile.language,
        goals=profile.goals
    )

    # –°–æ–∑–¥–∞–µ–º —Ç–µ–º—ã
    for topic_data in initial_topics:
        topic = Topic(
            profile_id=profile.id,
            name=topic_data.name,
            description=topic_data.description,
            type=topic_data.type,
            is_active=True
        )
        await db.save(topic)
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç–µ–º—ã –ø–æ —É—Ä–æ–≤–Ω—é:**

**A1:**
- –ë–∞–∑–æ–≤–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞ (Present Simple, –∞—Ä—Ç–∏–∫–ª–∏)
- –ü—Ä–æ—Å—Ç–∞—è –ª–µ–∫—Å–∏–∫–∞ (—á–∏—Å–ª–∞, —Ü–≤–µ—Ç–∞, —Å–µ–º—å—è)
- –ë–∞–∑–æ–≤—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ (–∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ, –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ)

**B1:**
- –°—Ä–µ–¥–Ω—è—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞ (Past Perfect, —É—Å–ª–æ–≤–Ω—ã–µ)
- –¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ª–µ–∫—Å–∏–∫–∞ (—Ä–∞–±–æ—Ç–∞, —Ö–æ–±–±–∏)
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏ (–≤ –º–∞–≥–∞–∑–∏–Ω–µ, –≤ –æ—Ñ–∏—Å–µ)

**C1:**
- –°–ª–æ–∂–Ω–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞ (—Å—É–±—Ö—É–Ω—Ç–∏–≤, –ø–∞—Å—Å–∏–≤)
- –ò–¥–∏–æ–º—ã –∏ —Ñ—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã
- –§–æ—Ä–º–∞–ª—å–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ (–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã)

---

### 2. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è

**–°–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è:**

```python
async def adapt_difficulty(
    topic: Topic,
    profile: LanguageProfile
) -> str:
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Å–ª–µ–¥—É—é—â–µ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.
    """
    # 1. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
    recent_exercises = await db.query(ExerciseHistory).filter(
        ExerciseHistory.topic_id == topic.id
    ).order_by(
        ExerciseHistory.completed_at.desc()
    ).limit(10).all()

    if len(recent_exercises) < 3:
        return "medium"  # –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö

    # 2. –°—á–∏—Ç–∞–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å
    correct_count = sum(1 for ex in recent_exercises if ex.result == "correct")
    partial_count = sum(1 for ex in recent_exercises if ex.result == "partial")

    accuracy = (correct_count + partial_count * 0.5) / len(recent_exercises)

    # 3. –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å
    if accuracy < 0.4:
        # –°–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ - —É–ø—Ä–æ—â–∞–µ–º
        return "easy"
    elif accuracy > 0.85:
        # –°–ª–∏—à–∫–æ–º –ª–µ–≥–∫–æ - —É—Å–ª–æ–∂–Ω—è–µ–º
        return "hard"
    else:
        return "medium"
```

**–ú–µ—Ö–∞–Ω–∏–∑–º –∞–¥–∞–ø—Ç–∞—Ü–∏–∏:**

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–∏–∑–∫–∞—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å (<40%)**
```
–î–µ–π—Å—Ç–≤–∏—è:
1. –£–ø—Ä–æ—Å—Ç–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (shorter sentences, simpler vocabulary)
2. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø–æ–¥—Å–∫–∞–∑–æ–∫
3. –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ–æ—Ä–∏—é

–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:
"–ö–∞–∂–µ—Ç—Å—è, —ç—Ç–∞ —Ç–µ–º–∞ –≤—ã–∑—ã–≤–∞–µ—Ç –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–∏—è. –Ø —É–ø—Ä–æ—Å—Ç–∏–ª —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
–∏ –¥–æ–±–∞–≤–∏–ª –ø–æ–¥—Å–∫–∞–∑–∫–∏. –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ [—Å—Å—ã–ª–∫–∞]."
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—ã—Å–æ–∫–∞—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å (>85%)**
```
–î–µ–π—Å—Ç–≤–∏—è:
1. –£—Å–ª–æ–∂–Ω–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (longer sentences, advanced vocabulary)
2. –î–æ–±–∞–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –Ω—é–∞–Ω—Å—ã
3. –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–µ–º—ã

–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:
"–û—Ç–ª–∏—á–Ω–æ! –í—ã —Ö–æ—Ä–æ—à–æ —É—Å–≤–æ–∏–ª–∏ —ç—Ç—É —Ç–µ–º—É. –Ø —É—Å–ª–æ–∂–Ω–∏–ª —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è,
—á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—å—Å—è –¥–∞–ª—å—à–µ. –¢–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –Ω–æ–≤—ã–µ —Ç–µ–º—ã [—Å–ø–∏—Å–æ–∫]."
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 3: –°—Ä–µ–¥–Ω—è—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å (40-85%)**
```
–î–µ–π—Å—Ç–≤–∏—è:
1. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å
2. –í–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
3. –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫—É

–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:
"–í—ã —Ö–æ—Ä–æ—à–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—Ä—É–µ—Ç–µ! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è."
```

---

### 3. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —Ç–µ–º

**–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–æ–≤—ã–µ —Ç–µ–º—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ:**

**1. –ü—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ —Ç–µ–∫—É—â–∏–º —Ç–µ–º–∞–º:**
```python
async def suggest_next_topics(profile: LanguageProfile) -> list[Topic]:
    """
    –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–æ–≤—ã–µ —Ç–µ–º—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.
    """
    # –¢–µ–º—ã —Å –≤—ã—Å–æ–∫–æ–π —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å—é (>80%)
    mastered_topics = await db.query(Topic).filter(
        Topic.profile_id == profile.id,
        Topic.accuracy > 0.8,
        Topic.exercises_count > 10
    ).all()

    if not mastered_topics:
        return []

    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
    suggestions = await llm_service.suggest_related_topics(
        mastered_topics=mastered_topics,
        profile=profile
    )

    return suggestions
```

**2. –¶–µ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```python
# –ï—Å–ª–∏ —Ü–µ–ª—å "work" - –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –¥–µ–ª–æ–≤—É—é –ª–µ–∫—Å–∏–∫—É
# –ï—Å–ª–∏ —Ü–µ–ª—å "travel" - –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏
# –ï—Å–ª–∏ —Ü–µ–ª—å "study" - –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫—É—é –ª–µ–∫—Å–∏–∫—É
```

**3. –¢–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫:**
```python
# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º, –≤ –∫–∞–∫–∏—Ö —Ç–µ–º–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—à–∏–±–∞–µ—Ç—Å—è —á–∞—â–µ
# –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è
```

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```
üéØ –ù–æ–≤—ã–µ —Ç–µ–º—ã –¥–ª—è –≤–∞—Å:

1. Pret√©rito Indefinido
   –°–≤—è–∑–∞–Ω–∞ —Å: Pret√©rito Perfecto (—É—Å–≤–æ–µ–Ω–æ –Ω–∞ 87%)
   –°–ª–æ–∂–Ω–æ—Å—Ç—å: Medium
   "–û—Ç–ª–∏—á–Ω–æ–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ç–µ–º—ã –ø—Ä–æ—à–µ–¥—à–∏—Ö –≤—Ä–µ–º–µ–Ω"
   [–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–º—É]

2. –î–µ–ª–æ–≤–∞—è –∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ü–∏—è
   –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–µ–π —Ü–µ–ª–∏: –†–∞–±–æ—Ç–∞
   –°–ª–æ–∂–Ω–æ—Å—Ç—å: Medium-Hard
   "–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è"
   [–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–º—É]

3. –ê—Ä—Ç–∏–∫–ª–∏ –≤ –∏—Å–ø–∞–Ω—Å–∫–æ–º
   –ß–∞—Å—Ç–æ –æ—à–∏–±–∞–µ—Ç–µ—Å—å –≤: —Ä–æ–¥ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö
   –°–ª–æ–∂–Ω–æ—Å—Ç—å: Easy-Medium
   "–ü–æ–º–æ–∂–µ—Ç —É—Å—Ç—Ä–∞–Ω–∏—Ç—å —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏"
   [–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–º—É]
```

---

### 4. –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è

**–ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è:**

```python
async def check_level_up(profile: LanguageProfile):
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –≥–æ—Ç–æ–≤ –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫ –ø–æ–≤—ã—à–µ–Ω–∏—é —É—Ä–æ–≤–Ω—è.
    """
    # –ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è:
    # 1. –¢–æ—á–Ω–æ—Å—Ç—å > 85% –ø–æ –≤—Å–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º —Ç–µ–º–∞–º
    # 2. –ú–∏–Ω–∏–º—É–º 50 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
    # 3. –°—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π = "hard"

    active_topics = await get_active_topics(profile.id)

    if len(active_topics) < 3:
        return False  # –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–µ–º

    avg_accuracy = sum(t.accuracy for t in active_topics) / len(active_topics)

    total_exercises = await db.query(ExerciseHistory).filter(
        ExerciseHistory.profile_id == profile.id
    ).count()

    if avg_accuracy > 0.85 and total_exercises > 50:
        # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å
        await notify_level_up(profile)
        return True

    return False
```

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–≤—ã—à–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è:**
```
üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!

–í—ã –≥–æ—Ç–æ–≤—ã –∫ –ø–æ–≤—ã—à–µ–Ω–∏—é —É—Ä–æ–≤–Ω—è —Å B1 –Ω–∞ B2!

–í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
‚úÖ 87% —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ –≤—Å–µ–º —Ç–µ–º–∞–º
‚úÖ 62 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
‚úÖ –û—Ç–ª–∏—á–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ–º

–•–æ—Ç–∏—Ç–µ –ø–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å?
–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Å—Ç–∞–Ω—É—Ç —Å–ª–æ–∂–Ω–µ–µ, –Ω–æ –≤—ã —Å–ø—Ä–∞–≤–∏—Ç–µ—Å—å!

[–ü–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å] [–û—Å—Ç–∞—Ç—å—Å—è –Ω–∞ B1]
```

---

### –†–µ–∑—é–º–µ: –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å

| –¢–∏–ø –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ | –ß—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è | –ö–∞–∫ —á–∞—Å—Ç–æ | –ö—Ä–∏—Ç–µ—Ä–∏–∏ |
|---------------|--------------|-----------|----------|
| –ù–∞—á–∞–ª—å–Ω–∞—è | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç–µ–º—ã | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è | –£—Ä–æ–≤–µ–Ω—å CEFR, —Ü–µ–ª–∏ |
| –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π | –ü–æ—Å–ª–µ –∫–∞–∂–¥—ã—Ö 3-5 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π | –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ —Ç–µ–º–µ |
| –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ | –ù–æ–≤—ã–µ —Ç–µ–º—ã | –ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è —Ç–µ–º—ã | –ü—Ä–æ–≥—Ä–µ—Å—Å, —Ü–µ–ª–∏, –æ—à–∏–±–∫–∏ |
| –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è | –£—Ä–æ–≤–µ–Ω—å CEFR | –ü–æ—Å–ª–µ 50+ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π | –û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, —Å–ª–æ–∂–Ω–æ—Å—Ç—å |

---

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –¥–ª—è Telegram-–±–æ—Ç–∞ –∏–∑—É—á–µ–Ω–∏—è —è–∑—ã–∫–æ–≤, –≤–∫–ª—é—á–∞—è —Ç–∏–ø—ã —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π, –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ LLM, –ø—Ä–æ–≤–µ—Ä–∫—É –æ—Ç–≤–µ—Ç–æ–≤, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
